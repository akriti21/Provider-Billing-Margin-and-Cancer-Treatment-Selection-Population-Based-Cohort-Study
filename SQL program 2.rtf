{\rtf1\adeflang1025\ansi\ansicpg1252\uc1\adeff0\deff0\stshfdbch31505\stshfloch31506\stshfhich31506\stshfbi0\deflang1033\deflangfe1033\themelang1033\themelangfe0\themelangcs0{\fonttbl{\f0\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f4\fbidi \fswiss\fcharset0\fprq2{\*\panose 020b0604020202020204}Helvetica;}
{\f34\fbidi \froman\fcharset0\fprq2{\*\panose 02040503050406030204}Cambria Math;}{\f43\fbidi \fswiss\fcharset0\fprq2 Aptos;}{\flomajor\f31500\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}
{\fdbmajor\f31501\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\fhimajor\f31502\fbidi \fswiss\fcharset0\fprq2 Aptos Display;}{\fbimajor\f31503\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}
{\flominor\f31504\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\fdbminor\f31505\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\fhiminor\f31506\fbidi \fswiss\fcharset0\fprq2 Aptos;}
{\fbiminor\f31507\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f1309\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\f1310\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}
{\f1312\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\f1313\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\f1314\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}
{\f1315\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\f1316\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\f1317\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\f1349\fbidi \fswiss\fcharset238\fprq2 Helvetica CE;}
{\f1350\fbidi \fswiss\fcharset204\fprq2 Helvetica Cyr;}{\f1352\fbidi \fswiss\fcharset161\fprq2 Helvetica Greek;}{\f1353\fbidi \fswiss\fcharset162\fprq2 Helvetica Tur;}{\f1354\fbidi \fswiss\fcharset177\fprq2 Helvetica (Hebrew);}
{\f1355\fbidi \fswiss\fcharset178\fprq2 Helvetica (Arabic);}{\f1356\fbidi \fswiss\fcharset186\fprq2 Helvetica Baltic;}{\f1357\fbidi \fswiss\fcharset163\fprq2 Helvetica (Vietnamese);}{\f1649\fbidi \froman\fcharset238\fprq2 Cambria Math CE;}
{\f1650\fbidi \froman\fcharset204\fprq2 Cambria Math Cyr;}{\f1652\fbidi \froman\fcharset161\fprq2 Cambria Math Greek;}{\f1653\fbidi \froman\fcharset162\fprq2 Cambria Math Tur;}{\f1656\fbidi \froman\fcharset186\fprq2 Cambria Math Baltic;}
{\f1657\fbidi \froman\fcharset163\fprq2 Cambria Math (Vietnamese);}{\f1739\fbidi \fswiss\fcharset238\fprq2 Aptos CE;}{\f1740\fbidi \fswiss\fcharset204\fprq2 Aptos Cyr;}{\f1742\fbidi \fswiss\fcharset161\fprq2 Aptos Greek;}
{\f1743\fbidi \fswiss\fcharset162\fprq2 Aptos Tur;}{\f1746\fbidi \fswiss\fcharset186\fprq2 Aptos Baltic;}{\f1747\fbidi \fswiss\fcharset163\fprq2 Aptos (Vietnamese);}{\flomajor\f31508\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}
{\flomajor\f31509\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}{\flomajor\f31511\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\flomajor\f31512\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}
{\flomajor\f31513\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\flomajor\f31514\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\flomajor\f31515\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}
{\flomajor\f31516\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\fdbmajor\f31518\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\fdbmajor\f31519\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}
{\fdbmajor\f31521\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\fdbmajor\f31522\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\fdbmajor\f31523\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}
{\fdbmajor\f31524\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\fdbmajor\f31525\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\fdbmajor\f31526\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}
{\fhimajor\f31528\fbidi \fswiss\fcharset238\fprq2 Aptos Display CE;}{\fhimajor\f31529\fbidi \fswiss\fcharset204\fprq2 Aptos Display Cyr;}{\fhimajor\f31531\fbidi \fswiss\fcharset161\fprq2 Aptos Display Greek;}
{\fhimajor\f31532\fbidi \fswiss\fcharset162\fprq2 Aptos Display Tur;}{\fhimajor\f31535\fbidi \fswiss\fcharset186\fprq2 Aptos Display Baltic;}{\fhimajor\f31536\fbidi \fswiss\fcharset163\fprq2 Aptos Display (Vietnamese);}
{\fbimajor\f31538\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\fbimajor\f31539\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}{\fbimajor\f31541\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}
{\fbimajor\f31542\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\fbimajor\f31543\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\fbimajor\f31544\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}
{\fbimajor\f31545\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\fbimajor\f31546\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\flominor\f31548\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}
{\flominor\f31549\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}{\flominor\f31551\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\flominor\f31552\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}
{\flominor\f31553\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\flominor\f31554\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\flominor\f31555\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}
{\flominor\f31556\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\fdbminor\f31558\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\fdbminor\f31559\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}
{\fdbminor\f31561\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\fdbminor\f31562\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\fdbminor\f31563\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}
{\fdbminor\f31564\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\fdbminor\f31565\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\fdbminor\f31566\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}
{\fhiminor\f31568\fbidi \fswiss\fcharset238\fprq2 Aptos CE;}{\fhiminor\f31569\fbidi \fswiss\fcharset204\fprq2 Aptos Cyr;}{\fhiminor\f31571\fbidi \fswiss\fcharset161\fprq2 Aptos Greek;}{\fhiminor\f31572\fbidi \fswiss\fcharset162\fprq2 Aptos Tur;}
{\fhiminor\f31575\fbidi \fswiss\fcharset186\fprq2 Aptos Baltic;}{\fhiminor\f31576\fbidi \fswiss\fcharset163\fprq2 Aptos (Vietnamese);}{\fbiminor\f31578\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}
{\fbiminor\f31579\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}{\fbiminor\f31581\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\fbiminor\f31582\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}
{\fbiminor\f31583\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\fbiminor\f31584\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\fbiminor\f31585\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}
{\fbiminor\f31586\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;
\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;\red0\green0\blue0;\red0\green0\blue0;}
{\*\defchp \fs24\kerning2\loch\af31506\hich\af31506\dbch\af31505 }{\*\defpap \ql \li0\ri0\sa160\sl278\slmult1\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 }\noqfpromote {\stylesheet{\ql \li0\ri0\sa160\sl278\slmult1
\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 \fs24\lang1033\langfe1033\kerning2\loch\f31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1033 \snext0 \sqformat \spriority0 
Normal;}{\*\cs10 \additive \ssemihidden \sunhideused \spriority1 Default Paragraph Font;}{\*
\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\tblind0\tblindtype3\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv \ql \li0\ri0\sa160\sl278\slmult1
\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 \fs24\lang1033\langfe1033\kerning2\loch\f31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1033 
\snext11 \ssemihidden \sunhideused Normal Table;}{\s15\ql \li0\ri0\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 
\fs24\lang1033\langfe1033\kerning2\loch\f31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1033 \snext15 \shidden \ssemihidden \styrsid16326042 Revision;}}{\*\revtbl {Unknown;}}{\*\rsidtbl \rsid328751\rsid345744\rsid2455645\rsid2890025\rsid4394130\rsid6255431
\rsid12414573\rsid12472050\rsid16326042}{\mmathPr\mmathFont34\mbrkBin0\mbrkBinSub0\msmallFrac0\mdispDef1\mlMargin0\mrMargin0\mdefJc1\mwrapIndent1440\mintLim0\mnaryLim1}{\info{\author Mishra, Akriti}{\operator Mishra, Akriti}
{\creatim\yr2025\mo8\dy5\hr11\min36}{\revtim\yr2025\mo8\dy5\hr11\min36}{\version2}{\edmins4}{\nofpages113}{\nofwords31599}{\nofchars180115}{\nofcharsws211292}{\vern103}}{\*\xmlnstbl {\xmlns1 http://schemas.microsoft.com/office/word/2003/wordml}}
\paperw12240\paperh15840\margl1440\margr1440\margt1440\margb1440\gutter0\ltrsect 
\widowctrl\ftnbj\aenddoc\trackmoves0\trackformatting1\donotembedsysfont0\relyonvml0\donotembedlingdata1\grfdocevents0\validatexml0\showplaceholdtext0\ignoremixedcontent0\saveinvalidxml0\showxmlerrors0\horzdoc\dghspace120\dgvspace120\dghorigin1701
\dgvorigin1984\dghshow0\dgvshow3\jcompress\viewkind1\viewscale100\rsidroot2455645 \fet0{\*\wgrffmtfilter 2450}\ilfomacatclnup0\ltrpar \sectd \ltrsect\linex0\sectdefaultcl\sftnbj {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl2
\pnucltr\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang {\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl6
\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang 
{\pntxtb (}{\pntxta )}}\pard\plain \ltrpar\ql \li0\ri0\nowidctlpar\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\wrapdefault\faauto\rin0\lin0\itap0\pararsid16326042 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 
\fs24\lang1033\langfe1033\kerning2\loch\af31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1033 {\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid16326042 \hich\af4\dbch\af31505\loch\f4 
/*************************************************************************}{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid12414573 \hich\af4\dbch\af31505\loch\f4 ************}{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid16326042 
\hich\af4\dbch\af31505\loch\f4 *********
\par 
\par \hich\af4\dbch\af31505\loch\f4 SQL program 2 \hich\f4 \endash \loch\f4  }{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid345744 
\par \hich\af4\dbch\af31505\loch\f4 W}{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid16326042 \hich\af4\dbch\af31505\loch\f4 as written to assign treatment regimen id and\hich\af4\dbch\af31505\loch\f4 
 treatment start date whenever and as available to the set of eligible patients identified in }{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid345744 \hich\af4\dbch\af31505\loch\f4 SQL}{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid16326042 
\hich\af4\dbch\af31505\loch\f4  program1
\par 
\par \hich\af4\dbch\af31505\loch\f4 **************************************************************************************}{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid12414573 \hich\af4\dbch\af31505\loch\f4 ********}{\rtlch\fcs1 \af4 \ltrch\fcs0 
\f4\kerning0\insrsid16326042 \hich\af4\dbch\af31505\loch\f4 ***/
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\wrapdefault\faauto\rin0\lin0\itap0 {\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid16326042 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /********************** 
\par \hich\af4\dbch\af31505\loch\f4 W\hich\af4\dbch\af31505\loch\f4 e first import (into the server) an excel sheet that has all the HCPCS codes as well as N\hich\af4\dbch\af31505\loch\f4 
DC codes applicable to the specific drugs we will be looking into **************************************************************************************************/
\par 
\par }{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid2890025 \hich\af4\dbch\af31505\loch\f4 proc import datafile = 'M:\\Mitchell\\Incentives\\Documentation\\treatment assignment with initiation date\\CWF Aim1_Trt Regimens_IV codes_WIP.xlsx'
\par \hich\af4\dbch\af31505\loch\f4 out = medserv.Trt_Reg_IV 
\par \hich\af4\dbch\af31505\loch\f4 dbms = xlsx replace; sheet = "Trts" ;
\par \hich\af4\dbch\af31505\loch\f4 run;
\par 
\par \hich\af4\dbch\af31505\loch\f4 proc import datafile = 'M:\\Mitchell\\Incentives\\Documentation\\treatment assignment with initiation date\\CWF Aim1_Trt Regimens_IV codes_WIP.xlsx'
\par \hich\af4\dbch\af31505\loch\f4 out = medserv.Trt_Reg_NDC 
\par \hich\af4\dbch\af31505\loch\f4 dbms = xlsx replace; sheet = "NDC" ;
\par \hich\af4\dbch\af31505\loch\f4 run;
\par 
\par 
\par 
\par }{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid12472050 
\par \hich\af4\dbch\af31505\loch\f4 /********************** For each scenario\hich\af4\dbch\af31505\loch\f4  -\hich\af4\dbch\af31505\loch\f4  we \hich\af4\dbch\af31505\loch\f4 first \hich\af4\dbch\af31505\loch\f4 
look through and pull claims corresponding to the partd fills as well as any procedures done to give IV drugs to the patients\hich\af4\dbch\af31505\loch\f4 
. This is done during the outcome period as applicable for each scenario (180 days after dx) in most cases. We identify treatment start date using first drug received (via fill or IV) and then limit to 60 days post this to assign a regimen using our avail
\hich\af4\dbch\af31505\loch\f4 able NCCN guidelines \hich\af4\dbch\af31505\loch\f4 at the time 
\par 
\par \hich\af4\dbch\af31505\loch\f4 If a scenario had an additional criteria u\hich\af4\dbch\af31505\loch\f4 sing the treatment start date and surgery/radiat\hich\af4\dbch\af31505\loch\f4 ion, then we apply that too in this file. 
\hich\af4\dbch\af31505\loch\f4 *********************************************************************/
\par 
\par 
\par }{\rtlch\fcs1 \af4 \ltrch\fcs0 \f4\kerning0\insrsid2890025 \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Breast6 ***************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 -------- get Part d fills for benes during fu
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_breast6_trts (
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Diag_Start_Date date NULL
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );
\par 
\par \hich\af4\dbch\af31505\loch\f4  with   IN_Breast6_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('ADO-TRASTUZUMAB EMTANSINE', 'CAPECITABINE', 'CARBOPLATIN', 'DOCETAXEL', 
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'LAPATINIB DITOSYLATE', 'PACLITAXEL PROTEIN-BOUND', 'PERTUZUMAB', 'TRASTUZUMAB', 'TUCATINI\hich\af4\dbch\af31505\loch\f4 B')),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast6_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast6 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs f\hich\af4\dbch\af31505\loch\f4 or benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast6_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast6 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast6_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast6 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for ben\hich\af4\dbch\af31505\loch\f4 es during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast6_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast6 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast6_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select \hich\af4\dbch\af31505\loch\f4 distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab \hich\af4\dbch\af31505\loch\f4       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast6 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast6_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_n\hich\af4\dbch\af31505\loch\f4 dc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast6 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Breast6_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast6_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast6_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Brea\hich\af4\dbch\af31505\loch\f4 st6_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast6_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast6_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast6_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast6_DME_ndc)
\par \hich\af4\dbch\af31505\loch\f4   ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_br6_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Adotrastuzumab emtansine', 'ADOTRASTUZUMAB EMTANSINE', 'ADO-TRASTUZUMAB EMTANSINE') then 1 else 0 end) as Ado_tras_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Capecitabine', 'CAPECITAB\hich\af4\dbch\af31505\loch\f4 INE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Carboplatin', 'CARBOPLATIN') then 1 else 0 end) as Carboplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Docetaxel', 'DOCETAXEL') then 1 else 0 end) as Docetaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Famtrastuzumab deruxtecannxki', 'FAMTRASTUZUMAB DERUXTECANNXKI') then 1 else 0 end) as Fam_tras_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Lapatinib', 'LAPATINIB', 'LAPATINIB DITOSYLATE') then 1 else 0 end) as Lapatinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Dru\hich\af4\dbch\af31505\loch\f4 g_category in ('Neratinib', 'NERATINIB') then 1 else 0 end) as Neratinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Paclitaxel', 'PACLITAXEL', 'PACLITAXEL PROTEIN-BOUND') then 1 else 0 end) as Paclitaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Pertuzumab', 'PERTUZUMAB') then 1 else 0 end) as Pertuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Trastuzumab', 'TRASTUZUMAB') then 1 else 0 end) as Trastuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Tucatinib', 'TUCATINIB') then 1 else 0 end) as Tucatinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when \hich\af4\dbch\af31505\loch\f4 Drug_category in ('Vinorelbine', 'VINORELBINE') then 1 else 0 end) as Vinorelbine_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Breast6_4trt where clm_dt <= end_fu group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_br6_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(ca\hich\af4\dbch\af31505\loch\f4 se when Ado_tras_fr >= 1 then 1 else 0 end) as Ado_tras_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Carboplatin_fr >= 1 then 1 else 0 end) as Carboplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Docetaxel_fr >= 1 then 1 else 0 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fam_tras_fr >= 1 then 1 else 0 end) as Fam_tras_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lapatinib_fr >= 1 then 1 else 0 end) as Lapatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Neratinib_fr >= 1 then 1 else 0 end) as Neratinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Paclitaxel_fr >= 1 then 1 else 0 end) as Pa\hich\af4\dbch\af31505\loch\f4 clitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pertuzumab_fr >= 1 then 1 else 0 end) as Pertuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Trastuzumab_fr >= 1 then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Tucatinib_fr >= 1 then 1 else 0 end) as Tucatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Vinorelbine_fr >= 1 then 1 else 0 end) as Vinorelbine_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_br6_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_br6_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \tab \hich\af4\dbch\af31505\loch\f4 Ado_tras_fl, Capecitabine_fl, Carboplatin_fl, Docetaxel_fl, Fam_tras_fl, Lapatinib_fl, Neratinib_fl,
\par \hich\af4\dbch\af31505\loch\f4     Paclitaxel_fl\hich\af4\dbch\af31505\loch\f4 , Pertuzumab_fl, Trastuzumab_fl, Tucatinib_fl, Vinorelbine_fl,
\par \tab \hich\af4\dbch\af31505\loch\f4 Ado_tras_fr, Capecitabine_fr, Carboplatin_fr, Docetaxel_fr, Fam_tras_fr, Lapatinib_fr, Neratinib_fr,
\par \hich\af4\dbch\af31505\loch\f4     Paclitaxel_fr, Pertuzumab_fr, Trastuzumab_fr, Tucatinib_fr, Vinorelbine_fr
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br6_finalelig_ids as a left join IN_br6_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab    left join IN_br6_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct Ado_tras_fl, Capecitabine_fl, Carboplatin_fl, Docetaxel_fl, Fam_tras_fl, Lapatinib_fl, Neratinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Paclitaxel_fl, Pertuzumab_fl, Trastuzumab_fl, Tucatinib_fl, Vinorelbine_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_br6_drugs
\par \hich\af4\dbch\af31505\loch\f4 --group by Ado_tras_fl, Capecitabine_fl, Carboplatin_fl, Docetaxel_fl, Fam_tras_fl, Lapatinib_fl, Neratinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Paclitaxel_fl, Pertuzumab_fl, Trastuzumab_fl, Tucatinib_fl, Vinorelbine_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60\hich\af4\dbch\af31505\loch\f4 days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_breast6_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_breast6_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---  benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_breast6_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Breast6_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4   \hich\af4\dbch\af31505\loch\f4   select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Adotrastuzumab emtansine', 'ADOTRASTUZUMAB EMTANSINE', 'ADO-TRASTUZUMAB EMTANSINE') then 1 else 0 end) as Ado_tras_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Carboplatin', 'CARBOPLATIN') then 1 else 0 end) as Carboplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Docetaxel', 'DOCETAXEL') then 1 else 0 end\hich\af4\dbch\af31505\loch\f4 ) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Famtrastuzumab deruxtecannxki', 'FAMTRASTUZUMAB DERUXTECANNXKI') then 1 else 0 end) as Fam_tras_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Lapatinib', 'LAPATINIB', 'LAPATINIB DITOSYLATE') then 1 else 0 end) as Lapatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Neratinib', 'NERATINIB') then 1 else 0 end) as Neratinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when \hich\af4\dbch\af31505\loch\f4 Drug_category in ('Paclitaxel', 'PACLITAXEL', 'PACLITAXEL PROTEIN-BOUND') then 1 else 0 end) as Paclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Pertuzumab', 'PERTUZUMAB') then 1 else 0 end) as Pertuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Trastuzumab', 'TRASTUZUMAB') then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Tucatinib', 'TUCATINIB') then 1 else 0 end) as Tucatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Vinorelbine', 'VINORELBINE') then 1 else 0 end) as Vinorelbine_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN\hich\af4\dbch\af31505\loch\f4 _Breast6_4trt a left join IN_Breast6_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Breast6_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Ado_tras_fl, Capecitabine_fl, Carboplatin_fl, Docetaxel_fl, Fam_tras_fl, Lapatinib_fl, Neratinib_fl,
\par \hich\af4\dbch\af31505\loch\f4              Paclitaxel_fl, Pertuzumab_fl, Trastuzumab_fl, Tucatinib_fl, Vinorelbine_fl,
\par \hich\af4\dbch\af31505\loch\f4              (Ado_tras_fl + Cape\hich\af4\dbch\af31505\loch\f4 citabine_fl+ Carboplatin_fl + Docetaxel_fl + Fam_tras_fl + Lapatinib_fl + Neratinib_fl +
\par \hich\af4\dbch\af31505\loch\f4              Paclitaxel_fl + Pertuzumab_fl + Trastuzumab_fl + Tucatinib_fl + Vinorelbine_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_br6_finalelig_ids a left join IN_Breast6_60d b on a.bene_id = b.bene_id)
\par \hich\af4\dbch\af31505\loch\f4  
\par \hich\af4\dbch\af31505\loch\f4  select distinct Ado_tras_fl, Capecitabine_fl, Carboplatin_fl, Docetaxel_fl, Fam_tras_fl, Lapatinib_fl, Neratinib_fl,
\par \hich\af4\dbch\af31505\loch\f4     Paclitaxel_fl, Pertuzumab_fl, Trastuzumab_fl, Tucatinib_fl, Vinorelbine_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 fr\hich\af4\dbch\af31505\loch\f4 om IN_all
\par \hich\af4\dbch\af31505\loch\f4 group by Ado_tras_fl, Capecitabine_fl, Carboplatin_fl, Docetaxel_fl, Fam_tras_fl, Lapatinib_fl, Neratinib_fl,
\par \hich\af4\dbch\af31505\loch\f4     Paclitaxel_fl, Pertuzumab_fl, Trastuzumab_fl, Tucatinib_fl, Vinorelbine_fl;
\par \hich\af4\dbch\af31505\loch\f4                             
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_breast6_trts
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4   (case 
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Pertuzumab_fl = 1 and Trastuzumab_fl = 1 and Docetaxel_fl = 1\tab \tab then 14102
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Pertuzumab_fl = 1\tab and Trastuzumab_fl = 1 and Paclitaxel_fl = 1\tab \tab then 14103
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Ado_tras_fl = 1\tab \tab \tab then 14104
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Trastuzumab_fl = 1 and Paclitaxel_fl = 1\tab and Carboplatin_fl = 1\tab \tab then 14105
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Trastuzumab_fl = 1 and Paclitaxel_fl = 1\tab \tab \tab then 14106
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Trast\hich\af4\dbch\af31505\loch\f4 uzumab_fl = 1 and Docetaxel_fl = 1 \tab \tab \tab then 14107
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Trastuzumab_fl = 1 and Vinorelbine_fl = 1\tab \tab \tab then 14108
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Trastuzumab_fl = 1 and Capecitabine_fl = 1\tab \tab \tab then 14109
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Lapatinib_fl = 1\tab \tab \tab then 14110
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Trastuzumab_fl = 1 and Capecitabine_fl = 1 and Lapatinib_fl = 1 \tab \tab \tab then 14111
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Trastuzumab_fl = 1 and Capecitabine_fl = 1 and Tucatinib_fl = 1\tab \tab \tab then 14133
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Fam_tras_fl\hich\af4\dbch\af31505\loch\f4  = 1\tab \tab \tab then 14134
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Neratinib_fl = 1\tab \tab \tab then 14135
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 4 and Carboplatin_fl = 1 and Docetaxel_fl = 1 and Pertuzumab_fl = 1 and Trastuzumab_fl = 1 then 888 -- non recommended
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Pertuzumab_fl = 1 and Trastuzumab_fl = 1 then 888 -- non recommended
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4         else 999 --- incomp regimens
\par \tab \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_all
\par \tab \hich\af4\dbch\af31505\loch\f4 ;
\par 
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, \hich\af4\dbch\af31505\loch\f4 count(distinct bene_ID) as benes from IN_check
\par \tab \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Breast7 ***************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- 'METHOTREXATE SODIUM' and 'METHOTREXATE SODIUM/PF' appear in PDE
\par \hich\af4\dbch\af31505\loch\f4 -- 'Capecitabine' does not appear at all in PDE. check DME NDC?
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get Part d fills for benes during fu
\par 
\par \hich\af4\dbch\af31505\loch\f4  with   IN_Breast7_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as a inner \hich\af4\dbch\af31505\loch\f4 join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAPECITABINE', 'CARBOPLATIN', 'CYCLOPHOSPHAMIDE', 'DOCETAXEL','DOXORUBICIN HCL',
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'FLUOROURACIL', 'METHOTREXATE SODIUM', 'METHOTREXATE SODIUM/PF', 'PACLITAXEL')),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast7_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as \hich\af4\dbch\af31505\loch\f4 a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY,\hich\af4\dbch\af31505\loch\f4  60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast7 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast7_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_St\hich\af4\dbch\af31505\loch\f4 art_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast7 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast7_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast7 = 1\hich\af4\dbch\af31505\loch\f4             \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast7_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast7 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast7_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as a inner join F\hich\af4\dbch\af31505\loch\f4 FS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast7 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast7_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids_f as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast7 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Breast7_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast7_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast7_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast7_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast7_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Sta\hich\af4\dbch\af31505\loch\f4 rt_Date, end_fu, clm_dt, Drug_category from IN_Breast7_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast7_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast7_DME_ndc)
\par \hich\af4\dbch\af31505\loch\f4   ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_br7_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID, sum(case when Drug_category in ('Doxorubicin', 'DOXORUBICIN HCL') then 1 else 0 end) as Doxorubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Cyclopho\hich\af4\dbch\af31505\loch\f4 sphamide', 'CYCLOPHOSPHAMIDE') then 1 else 0 end) as Cyclophosphamide_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Paclitaxel', 'PACLITAXEL') then 1 else 0 end) as Paclitaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Docetaxel', 'DOCETAXEL') then 1 else 0 end) as Docetaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Methotrexate', 'METHOTREXATE SODIUM', 'METHOTREXATE SODIUM/PF') then 1 else 0 end) as Methotrexate_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case\hich\af4\dbch\af31505\loch\f4  when Drug_category in ('Epirubicin', 'EPIRUBICIN') then 1 else 0 end) as Epirubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 ,sum(case when Drug_category in ('Carboplatin', 'CARBOPLATIN') then 1 else 0 end) as Carboplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Breast7_4trt where clm_dt <= end_fu group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_br7_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Doxorubicin_fr >= 1 then 1 else 0 end) as Doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cyclophosphamide_fr >= 1 then 1 else 0 end) as Cyclophosphamide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Paclitaxel_fr >= 1 then 1 else 0 end) as Paclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Docetaxel_fr >= 1 then 1 else 0 \hich\af4\dbch\af31505\loch\f4 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Methotrexate_fr >= 1 then 1 else 0 end) as Methotrexate_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Epirubicin_fr >= 1 then 1 else 0 end) as Epirubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Carboplatin_fr >= 1 then 1 else 0 end) as Carboplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_br7_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Br7_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \tab \hich\af4\dbch\af31505\loch\f4 b.Doxorubicin_fl, b.Cyclophosp\hich\af4\dbch\af31505\loch\f4 hamide_fl, b.Paclitaxel_fl, b.Docetaxel_fl, b.Methotrexate_fl, b.Fluorouracil_fl,
\par \tab \hich\af4\dbch\af31505\loch\f4 b.Epirubicin_fl, b.Capecitabine_fl, b.Carboplatin_fl,
\par \tab \hich\af4\dbch\af31505\loch\f4 Doxorubicin_fr, Cyclophosphamide_fr, Paclitaxel_fr, Docetaxel_fr, Methotrexate_fr, Fluorouracil_fr,
\par \tab \hich\af4\dbch\af31505\loch\f4 Epirubicin_fr, Capecitabine_fr, Carboplatin_fr
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids as a left join IN_br7_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab \hich\af4\dbch\af31505\loch\f4   left join IN_br7_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4  ,IN_doxu as (
\par \hich\af4\dbch\af31505\loch\f4     select BENE_ID, clm_dt, row_number() over(partition by bene_id order by clm_dt) as RowNum
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Doxorubicin', 'DOXORUBICIN HCL')
\par \hich\af4\dbch\af31505\loch\f4     )
\par 
\par \hich\af4\dbch\af31505\loch\f4 ,doxu_1 as (select BENE_ID, clm_dt as doxu_1st from IN_doxu where RowNum = 1)
\par \hich\af4\dbch\af31505\loch\f4 ,doxu_4 as (select BENE_ID, clm_dt as doxu_4th from IN_doxu where RowNum = 4)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , doxu as (
\par \hich\af4\dbch\af31505\loch\f4     select distinct bene_ID, min(clm_dt) as doxu_1st, max(clm_dt) as doxu_last, 
\par \hich\af4\dbch\af31505\loch\f4      count(distinct clm_dt) as doxu_clms
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Doxorubicin', 'DOXORUBICIN HCL')
\par \hich\af4\dbch\af31505\loch\f4     group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_cycl as (
\par \hich\af4\dbch\af31505\loch\f4     select distinct bene_ID, min(clm_dt) as cycl_1st, max(clm_dt) as cycl_last, 
\par \hich\af4\dbch\af31505\loch\f4      count(distinct clm_dt) as cycl_clms
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Cyclophosphamide', 'CYCLOPHOSPHAMIDE')
\par \hich\af4\dbch\af31505\loch\f4     group by bene_ID)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_pacl as (
\par \hich\af4\dbch\af31505\loch\f4     select distinct bene_ID, min(clm_dt) as pacl_1st, max(clm_dt) as pacl_last, 
\par \hich\af4\dbch\af31505\loch\f4      count(distinct clm_dt) as pacl_clms
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Paclitaxel', 'PACLITAXEL')
\par \hich\af4\dbch\af31505\loch\f4     group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_doce as (
\par \hich\af4\dbch\af31505\loch\f4     select distinct bene_ID, min(clm_dt) as doce_1st, max(clm_dt) as doce_last, 
\par \hich\af4\dbch\af31505\loch\f4      count(distinct clm_dt) as doce_clms
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Docetaxel', 'DOCETAXEL')
\par \hich\af4\dbch\af31505\loch\f4     group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_fluo as (
\par \hich\af4\dbch\af31505\loch\f4     select distinct bene_ID, min(clm_dt)\hich\af4\dbch\af31505\loch\f4  as fluo_1st, max(clm_dt) as fluo_last, 
\par \hich\af4\dbch\af31505\loch\f4      count(distinct clm_dt) as fluo_clms
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Fluorouracil', 'FLUOROURACIL')
\par \hich\af4\dbch\af31505\loch\f4     group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_epi as (
\par \hich\af4\dbch\af31505\loch\f4     select distinct bene_ID, min(clm_dt) as epi_1st, max(clm_dt) as epi_last, 
\par \hich\af4\dbch\af31505\loch\f4      count(distinct clm_dt) as epi_clms
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Epirubicin', 'EPIRUBICIN')
\par \hich\af4\dbch\af31505\loch\f4     group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_doxu_all as (select distinct bene_ID, clm_dt as doxu_clm 
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Doxorubicin', 'DOXORUBICIN HCL')
\par \hich\af4\dbch\af31505\loch\f4                    )
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_doce_all as (select distinct bene_ID, clm_dt as doce_clm 
\par \hich\af4\dbch\af31505\loch\f4     from IN_Breast7_4trt where Drug_category in ('Docetaxel', 'DOCETAXEL')
\par \hich\af4\dbch\af31505\loch\f4                    )
\par \hich\af4\dbch\af31505\loch\f4 ,IN_doxu_doce as 
\par \hich\af4\dbch\af31505\loch\f4          (select distinct a.bene_ID, a.doxu_clm, b.doce_clm from
\par \hich\af4\dbch\af31505\loch\f4          \tab IN_doxu_all a inner join IN_doce_all b on a.bene_id = b.bene_id)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---select top 5 * from IN_doxu_doce; 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ,IN_fortrt as (
\par \hich\af4\dbch\af31505\loch\f4    select distinct a.bene_ID, Diag\hich\af4\dbch\af31505\loch\f4 _Start_Date, end_fu, b.Doxorubicin_fl, b.Cyclophosphamide_fl, b.Paclitaxel_fl, 
\par \hich\af4\dbch\af31505\loch\f4    b.Docetaxel_fl, b.Methotrexate_fl, b.Fluorouracil_fl, b.Epirubicin_fl, b.Capecitabine_fl, b.Carboplatin_fl,
\par \hich\af4\dbch\af31505\loch\f4    c.doxu_last, c1.doxu_1st, c2.doxu_4th, d.cycl_1st, d.cycl_last, d.cycl_clms, e.pacl_1st, e.pacl_last, e.pacl_clms,
\par \hich\af4\dbch\af31505\loch\f4    f.doce_1st, f.doce_last, f.doce_clms, g.fluo_1st, g.fluo_last, g.fluo_clms, h.epi_1st, h.epi_last, h.epi_clms
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br7_chckelig_ids as a left join IN_br7_drugflag as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4   \hich\af4\dbch\af31505\loch\f4                             left join doxu  as c on a.bene_id = c.bene_id \tab     
\par \tab \hich\af4\dbch\af31505\loch\f4                               left join doxu_1  as c1 on a.bene_id = c1.bene_id 
\par \tab \hich\af4\dbch\af31505\loch\f4                               left join doxu_4  as c2 on a.bene_id = c2.bene_id 
\par \tab \hich\af4\dbch\af31505\loch\f4                               left join IN_cycl as d on a.bene_id = d.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4                               left join IN_pacl as e on a.bene_id = e.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4                               left join IN_doce as f on a.bene_id = f.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4                               \hich\af4\dbch\af31505\loch\f4 left join IN_fluo as g on a.bene_id = g.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4                               left join IN_epi as h on a.bene_id = h.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4                                                  )
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_fortrt_f as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct bene_ID, 
\par \tab \hich\af4\dbch\af31505\loch\f4 (case when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and Paclitaxel_fl = 1 and 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4        doxu_4th is not NULL and (DATEDIFF(day, doxu_1st, doxu_4th) <= 49) and (pacl_clms <= 6) and (pacl_1st >= doxu_4th and pacl_1st >= cycl_last)
\par \tab \hich\af4\dbch\af31505\loch\f4             then '14001'
\par \hich\af4\dbch\af31505\loch\f4           when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and Paclitaxel_fl = 1 and 
\par \hich\af4\dbch\af31505\loch\f4                doxu_4th is not NULL and (DATEDIFF(day, doxu_1st, doxu_4th) <= 49) and (pacl_clms >= 7) and (pacl_1st >= doxu_4th and pacl_1st >= cycl_last)\tab       
\par \hich\af4\dbch\af31505\loch\f4                 then '14002'
\par \hich\af4\dbch\af31505\loch\f4           when Cyclophosphamide_fl = 1 and Docetaxel_fl = 1
\par \hich\af4\dbch\af31505\loch\f4                 then '14003'
\par \hich\af4\dbch\af31505\loch\f4           when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4        doxu_4th is not NULL and (DATEDIFF(day, doxu_1st, doxu_4th) <= 49) then '14004'
\par \hich\af4\dbch\af31505\loch\f4           when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4        doxu_4th is not NULL and (DATEDIFF(day, doxu_1st, doxu_4th) >= 56) then '14005'
\par \hich\af4\dbch\af31505\loch\f4           when Cyclophosphamide_fl = 1 and Methotrexate_fl = 1 and Fluorouracil_f\hich\af4\dbch\af31505\loch\f4 l = 1 then '14006'
\par \hich\af4\dbch\af31505\loch\f4           when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and Docetaxel_fl = 1 and 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4        doxu_4th is not NULL and (DATEDIFF(day, doxu_1st, doxu_4th) >= 56) and (doce_1st >= doxu_4th) then '14008'
\par \hich\af4\dbch\af31505\loch\f4           when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and Paclitaxel_fl = 1 and 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4        doxu_4th is not NULL and (DATEDIFF(day, doxu_1st, doxu_4th) >= 56) and (pacl_clms >= 7) and (pacl_1st >= doxu_4th and pacl_1st >= cycl_last) then '14007'
\par \hich\af4\dbch\af31505\loch\f4           when Epirubicin_fl = 1 and \hich\af4\dbch\af31505\loch\f4 Cyclophosphamide_fl = 1 then '14009'
\par \hich\af4\dbch\af31505\loch\f4           when Docetaxel_fl = 1 and Fluorouracil_fl = 1 and Epirubicin_fl = 1 and Cyclophosphamide_fl = 1 and 
\par \hich\af4\dbch\af31505\loch\f4                (doce_1st >= fluo_last and doce_1st >= epi_last and doce_1st >= cycl_last) then '14139'
\par \hich\af4\dbch\af31505\loch\f4           when Paclitaxel_fl = 1 and Fluorouracil_fl = 1 and Epirubicin_fl = 1 and Cyclophosphamide_fl = 1 and 
\par \hich\af4\dbch\af31505\loch\f4                (pacl_1st >= fluo_last and pacl_1st >= epi_last and pacl_1st >= cycl_last) then '14140'
\par \hich\af4\dbch\af31505\loch\f4           when Paclitaxel_fl = 1 and Fluorouracil_fl = 1 and Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and 
\par \hich\af4\dbch\af31505\loch\f4                (pacl_1st >= fluo_last and pacl_1st >= doxu_last and pacl_1st >= cycl_last) then '14141'
\par \hich\af4\dbch\af31505\loch\f4           
\par \hich\af4\dbch\af31505\loch\f4 --          when Doxorubicin_fl = 1 and Cyclophosphamide_fl = 1 and D\hich\af4\dbch\af31505\loch\f4 ocetaxel_fl = 1
\par \hich\af4\dbch\af31505\loch\f4   --        then '14101'          
\par 
\par \hich\af4\dbch\af31505\loch\f4           when Paclitaxel_fl = 1 and Carboplatin_fl = 1 then '14112'\tab 
\par \hich\af4\dbch\af31505\loch\f4           when Docetaxel_fl = 1 and Carboplatin_fl = 1 then '14113'
\par 
\par \hich\af4\dbch\af31505\loch\f4                      end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_fortrt)
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count (distinct bene_ID) from
\par \hich\af4\dbch\af31505\loch\f4 IN_fortrt_f group by trtreg
\par 
\par ---------
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct b.Doxorubicin_fl, b.Cyclophosphamide_fl, b.Paclitaxel_fl, b.Docetaxel_fl, b.Methotrexate_fl, b.Fluorouracil_fl,
\par \tab \hich\af4\dbch\af31505\loch\f4 b.Epirubicin_fl, b.Capecitabine_fl, b.Carbopl\hich\af4\dbch\af31505\loch\f4 atin_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 from IN_Br7_drugs b
\par \hich\af4\dbch\af31505\loch\f4 group by b.Doxorubicin_fl, b.Cyclophosphamide_fl, b.Paclitaxel_fl, b.Docetaxel_fl, b.Methotrexate_fl, b.Fluorouracil_fl,
\par \tab \hich\af4\dbch\af31505\loch\f4 b.Epirubicin_fl, b.Capecitabine_fl, b.Carboplatin_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 --------- 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Breast8 ***************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get Part d fills for benes during fu
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- for oral fill, do not include 'PACLITAXEL PROTEIN-BOUND ?'. and epirubicin is only in IV\tab 
\par \hich\af4\dbch\af31505\loch\f4  with   IN_Breast8_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_cat\hich\af4\dbch\af31505\loch\f4 egory
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('ADO-TRASTUZUMAB EMTANSINE',\tab 'CARBOPLATIN',\tab 'CYCLOPHOSPHAMIDE',\tab 'DOCETAXEL',\tab 
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 'DOXORUBICIN HCL',\tab 'FLUOROURACIL',\tab 'PACLITAXEL',\tab 'PERTUZUMAB',\tab 'TRASTUZUMAB')),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast8_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_cate\hich\af4\dbch\af31505\loch\f4 gory
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast8 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast8_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select disti\hich\af4\dbch\af31505\loch\f4 nct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast8 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast8_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST\hich\af4\dbch\af31505\loch\f4 _EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast8 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast8_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Breast8 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast8_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join \hich\af4\dbch\af31505\loch\f4 FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast8 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Breast8_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_br8_chckelig_ids_f as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Breast8 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Breast8_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast8_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast8_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast8_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast8_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Sta\hich\af4\dbch\af31505\loch\f4 rt_Date, end_fu, clm_dt, Drug_category from IN_Breast8_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast8_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Breast8_DME_ndc)
\par \hich\af4\dbch\af31505\loch\f4   ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_br8_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ado-trastuzumab emtansine', 'ADO-TRASTUZUMAB EMTANSINE', 'Adotrastuzumab emtansine') then 1 else 0 end) as Ado_\hich\af4\dbch\af31505\loch\f4 tras_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Carboplatin', 'CARBOPLATIN') then 1 else 0 end) as Carboplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cyclophosphamide', 'CYCLOPHOSPHAMIDE') then 1 else 0 end) as Cyclophosphamide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Docetaxel', 'DOCETAXEL') then 1 else 0 end) as Docetaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Doxorubicin', 'DOXORUBICIN HCL') then 1 else 0 end) as Doxorubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Epirubicin') then 1 else 0 end) as Epirubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 , s\hich\af4\dbch\af31505\loch\f4 um(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Paclitaxel', 'PACLITAXEL') then 1 else 0 end) as Paclitaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Pertuzumab', 'PERTUZUMAB') then 1 else 0 end) as Pertuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Trastuzumab', 'TRASTUZUMAB') then 1 else 0 end) as Trastuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Breast8_4trt where clm_dt <= end_fu group by bene_ID),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_br8_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ado_tras_fr >= 1 then 1 else 0 end) as Ado_tras_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Carboplatin_fr >= 1 then 1 else 0 end) as Carboplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cyclophosphamide_fr >= 1 then 1 else 0 end) as Cyclophosphamide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Docetaxel_fr >= 1 then 1 else 0 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Doxorubicin_fr >= 1 then 1 else 0 end) as Doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when E\hich\af4\dbch\af31505\loch\f4 pirubicin_fr >= 1 then 1 else 0 end) as Epirubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Paclitaxel_fr >= 1 then 1 else 0 end) as Paclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pertuzumab_fr >= 1 then 1 else 0 end) as Pertuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Trastuzumab_fr >= 1 then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_br8_drugfreq),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_br8_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \tab \hich\af4\dbch\af31505\loch\f4 Ado_tras_fl,\tab Carboplatin_fl,\tab Cyclophosphamide_fl,\tab Docetaxel_fl,\tab Doxorubic\hich\af4\dbch\af31505\loch\f4 in_fl,\tab 
\par \hich\af4\dbch\af31505\loch\f4     Epirubicin_fl,\tab Fluorouracil_fl,\tab Paclitaxel_fl,\tab Pertuzumab_fl,\tab Trastuzumab_fl,
\par \hich\af4\dbch\af31505\loch\f4     Ado_tras_fr,\tab Carboplatin_fr,\tab Cyclophosphamide_fr,\tab Docetaxel_fr,\tab Doxorubicin_fr,\tab 
\par \hich\af4\dbch\af31505\loch\f4     Epirubicin_fr,\tab Fluorouracil_fr,\tab Paclitaxel_fr,\tab Pertuzumab_fr,\tab \hich\af4\dbch\af31505\loch\f4 Trastuzumab_fr    
\par \hich\af4\dbch\af31505\loch\f4     \tab from IN_br8_chckelig_ids as a left join IN_br8_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab       left join IN_br8_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct Ado_tras_fl,\tab Carboplatin_fl,\tab Cyclophosphamide_fl,\tab Docetaxel_fl,\tab Doxorubicin_fl,\tab 
\par \hich\af4\dbch\af31505\loch\f4     Epirubicin_fl,\tab Fluorouracil_fl,\tab Paclitaxel_fl,\tab Pertuzumab_fl,\tab Trastuzumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 from IN_br8_drugs b
\par \hich\af4\dbch\af31505\loch\f4 group by Ado_tras_fl,\tab Carboplatin_fl,\tab Cyclophosphamide_fl,\tab Docetaxel_fl,\tab Do\hich\af4\dbch\af31505\loch\f4 xorubicin_fl,\tab 
\par \hich\af4\dbch\af31505\loch\f4     Epirubicin_fl,\tab Fluorouracil_fl,\tab Paclitaxel_fl,\tab Pertuzumab_fl,\tab Trastuzumab_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 --------- 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Rectum2 ***************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Rectum2_4trt_a (
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Diag_Start_Date date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Capecitabine_fl varchar(1),Fluorouracil_fl varchar(1),Oxaliplatin_fl varchar(1), Radiation_fl varchar(1), 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Pump_fl varchar(1),
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 alldrugs INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 radiation_fr INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 first_rad date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 last_rad date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 surg_dt date NULL,
\par --\tab \tab \hich\af4\dbch\af31505\loch\f4 first_ox date NULL, first_fu date NULL
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );
\par 
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index reca on IN_Rectum2_4trt_a;
\par \hich\af4\dbch\af31505\loch\f4  with IN_Rectum2_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAPECITABINE',\tab 'FLUOROURACIL',\tab 'OXALIPLATIN')),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes d\hich\af4\dbch\af31505\loch\f4 uring fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select dis\hich\af4\dbch\af31505\loch\f4 tinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID\hich\af4\dbch\af31505\loch\f4 , Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Dia\hich\af4\dbch\af31505\loch\f4 g_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.\hich\af4\dbch\af31505\loch\f4 icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab \hich\af4\dbch\af31505\loch\f4        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_p\hich\af4\dbch\af31505\loch\f4 roc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DAT\hich\af4\dbch\af31505\loch\f4 EADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Rectum2_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, \hich\af4\dbch\af31505\loch\f4 clm_dt, Drug_category, surg_dt from IN_Rectum2_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_OP_\hich\af4\dbch\af31505\loch\f4 I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Rectum2_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Radiation') then 1 else 0 end) as Radiation_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_ca\hich\af4\dbch\af31505\loch\f4 tegory in ('Pump') then 1 else 0 end) as Pump_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum2_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Oxaliplatin_fr >= 1 then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Radiation_fr >= 1 then 1 else 0 end) as Radiation_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pump_fr >= 1 then 1 else 0 end) as Pump_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum2_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, a.surg_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4 Capecitabine_fl,\tab Fluorouracil_fl,\tab Oxaliplatin_fl,\tab R\hich\af4\dbch\af31505\loch\f4 adiation_fl, Pump_fl,
\par \hich\af4\dbch\af31505\loch\f4     Capecitabine_fr,\tab Fluorouracil_fr,\tab Oxaliplatin_fr,\tab Radiation_fr, Pump_fr
\par \hich\af4\dbch\af31505\loch\f4     \tab from IN_rectum2_nonmeta_benes_f as a left join IN_Rectum2_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab              left join IN_Rectum2_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab Capecitabine_fl,\tab Fluorouracil_fl,\tab Oxaliplatin_fl,\tab Radiation_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Rectum2_drugs b
\par \hich\af4\dbch\af31505\loch\f4 --group by \tab Capecitabine_fl,\tab Fluorouracil_fl,\tab Oxaliplatin_fl,\tab Rad\hich\af4\dbch\af31505\loch\f4 iation_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_rectum2_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, 
\par \tab \hich\af4\dbch\af31505\loch\f4             DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene,
\par \tab \hich\af4\dbch\af31505\loch\f4             (case when DATEADD(DAY, 60, min(clm_dt)) <= surg_dt then DATEADD(DAY, 60, min(clm_dt))
\par \tab \hich\af4\dbch\af31505\loch\f4             \tab   when DATEADD(DAY, 60, min(clm_dt)) > surg_dt  then surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4             \tab   end) as end_fu_bene_surg  from IN_rectum2_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID, end_fu, surg_dt)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ,IN_rectum2_rad_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID  
\par \hich\af4\dbch\af31505\loch\f4 , count(distinct clm_dt) as Radiation_fr, min(clm_dt) as first_rad, max(clm_dt) as last_rad
\par \hich\af4\dbch\af31505\loch\f4 from \hich\af4\dbch\af31505\loch\f4 IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_surg and a.Drug_category in ('Radiation')
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --,IN_rectum2_fuall_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4 --    select distinct a.BENE_ID, clm_dt as fu_clms from IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 --where a.clm_dt <= b.end_fu_bene and a.Drug_category in ('Fluorouracil', 'FLUOROURACIL'))
\par \hich\af4\dbch\af31505\loch\f4  
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per f\hich\af4\dbch\af31505\loch\f4 irst med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_rectum2_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene_surg, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Radiation') then 1 else 0 end) as Radiation_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Pump') then 1 else 0 end) as Pump_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_surg
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene_surg, b.trtinit_dt)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select top 5 * from IN_rectum2_60d; 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_rectum\hich\af4\dbch\af31505\loch\f4 2_60d
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Rectum2_4trt_a
\par \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Capecitabine_fl, Fluorouracil_fl, Oxaliplatin_fl, Radiation_fl, Pump_fl,
\par \hich\af4\dbch\af31505\loch\f4              (Capecitabine_fl + Fluorouracil_fl + Oxaliplatin_fl + Radiation_fl) as alldrugs,
\par \hich\af4\dbch\af31505\loch\f4              c.radiation_fr, c.first_rad, c.last_rad, a.surg_dt--, first_ox, first_fu
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4  --, rad1, rad2, rad3, rad4, rad5, rad6, rad7 
\par \hich\af4\dbch\af31505\loch\f4               --, fu_clms, first_fu  from
\par \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f a left join IN_Rectum2_60d b \hich\af4\dbch\af31505\loch\f4 on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                               left join IN_rectum2_rad_60d c on a.bene_ID = c.bene_ID
\par \tab \tab \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 --  left join IN_rectum2_ox_60d o on a.BENE_ID = o.bene_ID
\par \hich\af4\dbch\af31505\loch\f4                             --  left join IN_raddays_piv c2 on a.bene_id = c2.bene_id)
\par \hich\af4\dbch\af31505\loch\f4                             --  left join IN_rectum2_fu_60d d on a.bene_id = d.bene_id;
\par \tab \tab \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 --  left join IN_rectum2_fuall_60d d2 on a.BENE_ID = d2.BENE_ID
\par \hich\af4\dbch\af31505\loch\f4                              
\par \hich\af4\dbch\af31505\loch\f4 --select count(distinct bene_ID)  from IN_Rectum2_4trt_a;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct  Capecitabine_fl, Fluorouracil_fl, Oxaliplatin_fl, Radiation_fl,count (distinct bene_ID) as benes from IN_rectum2_60d
\par \hich\af4\dbch\af31505\loch\f4 group by Capecitabine_fl, Fluorouracil_fl, Oxaliplatin_fl, Radiation_fl
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Rectum2_4trt_b (
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Diag_Start_Date date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Capecitabine_fl varchar(1),Fluorouracil_fl varchar(1),Oxaliplatin_fl varchar(1), Radiation_\hich\af4\dbch\af31505\loch\f4 fl varchar(1), 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 Pump_fl varchar(1),
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 alldrugs INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 radiation_fr INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 first_rad date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 last_rad date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 surg_dt date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 first_cap date NULL, first_ox date NULL,
\par \hich\af4\dbch\af31505\loch\f4         rad7 date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );
\par 
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index reca on IN_Rectum2_4trt_b;
\par \hich\af4\dbch\af31505\loch\f4  \tab \tab \tab  
\par \hich\af4\dbch\af31505\loch\f4  with IN_Rectum2_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAPECITABINE',\tab 'FLUOROURACIL',\tab 'OXALIPLATIN')),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, sur\hich\af4\dbch\af31505\loch\f4 g_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum\hich\af4\dbch\af31505\loch\f4 2_nonmeta_benes_f as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Sta\hich\af4\dbch\af31505\loch\f4 rt_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu\hich\af4\dbch\af31505\loch\f4 , b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.D\hich\af4\dbch\af31505\loch\f4 rug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, en\hich\af4\dbch\af31505\loch\f4 d_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as\hich\af4\dbch\af31505\loch\f4  clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_re\hich\af4\dbch\af31505\loch\f4 ctum2_nonmeta_benes_f as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_f\hich\af4\dbch\af31505\loch\f4 u ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Rectum2_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, e\hich\af4\dbch\af31505\loch\f4 nd_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rect\hich\af4\dbch\af31505\loch\f4 um2_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   )
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_rectum2_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, 
\par \tab \hich\af4\dbch\af31505\loch\f4             DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene,
\par \tab \hich\af4\dbch\af31505\loch\f4             (case when DATEADD(DAY, 60, min(clm_dt)) <= surg_dt then DATEADD(DAY, 60, min(clm_dt))
\par \tab \hich\af4\dbch\af31505\loch\f4             \tab   when DATEADD(DAY, 60, min(clm_dt)) > surg_dt  then surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4             \tab   end) as end_fu_bene_surg  from IN_rectum2_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID, end_fu, \hich\af4\dbch\af31505\loch\f4 surg_dt)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ,IN_rectum2_cap_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, min(clm_dt) as first_cap
\par \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_surg and a.Drug_category in ('Capecitabine', 'CAPECITABINE')
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID)
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ,IN_rectum2_ox_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, min(clm_dt) as first_ox
\par \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_surg and a.Drug_category in ('Oxa\hich\af4\dbch\af31505\loch\f4 liplatin', 'OXALIPLATIN')
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_raddays as (
\par \hich\af4\dbch\af31505\loch\f4            select a.BENE_ID, a.clm_dt,
\par \hich\af4\dbch\af31505\loch\f4            row_number() over(partition by a.bene_id order by a.clm_dt) as RowNum
\par \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_surg and a.Drug_category in ('Radiation'))
\par \tab 
\par ---
\par \hich\af4\dbch\af31505\loch\f4 , IN_raddays_piv as (SELECT distinct bene_ID,      
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=7 then clm_dt end) as rad7
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_raddays group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Rectum2_4trt_b
\par \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, a.Diag_Start_Date, a.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Capecitabine_fl, Fluorouracil_fl, Oxaliplatin_fl, Radiation_fl, Pump_fl, alldrugs,
\par \hich\af4\dbch\af31505\loch\f4              radiation_fr, first_rad, last_rad, surg_dt, first_cap, first_ox 
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4  , rad7--, first_fu, fu1, fu2, fu3, fu4, fu5, fu6, fu7
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum2_4trt_a a\tab   left join IN_rectum2_cap_60d c on a.BENE_ID = c.bene_ID
\par \hich\af4\dbch\af31505\loch\f4                               left join IN_rectum2_ox_60d o on a.BENE_ID = o.bene_ID
\par \hich\af4\dbch\af31505\loch\f4                               left join IN_raddays_piv r on a.bene_id = r.bene_id
\par \tab \tab \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4   --left join IN_rectum2_f\hich\af4\dbch\af31505\loch\f4 u_60d f1 on a.bene_id = f1.bene_id
\par \hich\af4\dbch\af31505\loch\f4                               --left join IN_fudays_piv f on a.bene_id = f.bene_id)
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ***********************;
\par 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Rectum2_trts (\tab \tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab \tab \tab 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Rectum2_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAPECITABINE',\tab 'FLUOROURACIL',\tab 'OXALIPLATIN')),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH proc\hich\af4\dbch\af31505\loch\f4 s for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes dur\hich\af4\dbch\af31505\loch\f4 ing fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_R\hich\af4\dbch\af31505\loch\f4 ectum2_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab \hich\af4\dbch\af31505\loch\f4       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV \hich\af4\dbch\af31505\loch\f4 as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC\hich\af4\dbch\af31505\loch\f4 _code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, e\hich\af4\dbch\af31505\loch\f4 nd_fu, b.icd_proc_dt as clm_dt, c.Drug_category, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum2_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_catego\hich\af4\dbch\af31505\loch\f4 ry, surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_nonmeta_benes_f as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Rectum2_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_categ\hich\af4\dbch\af31505\loch\f4 ory, surg_dt from IN_Rectum2_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select di\hich\af4\dbch\af31505\loch\f4 stinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category, surg_dt from IN_Rectum2_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, D\hich\af4\dbch\af31505\loch\f4 rug_category, surg_dt from IN_Rectum2_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_rectum2_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, 
\par \tab \hich\af4\dbch\af31505\loch\f4             DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene,
\par \tab \hich\af4\dbch\af31505\loch\f4             (case when DATEADD(DAY, 60, min(clm_dt)) <= surg_dt then DATEADD(DAY, 60, min(clm_dt))
\par \tab \hich\af4\dbch\af31505\loch\f4             \tab   when DATEADD(DAY, 60, min(clm_dt)) > surg_dt  then surg_dt
\par \tab \hich\af4\dbch\af31505\loch\f4             \tab   end) as end_fu_bene_surg  from IN_rectum2_4tr\hich\af4\dbch\af31505\loch\f4 t where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID, end_fu, surg_dt)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_fudays as (
\par \hich\af4\dbch\af31505\loch\f4            select a.BENE_ID, a.clm_dt,
\par \hich\af4\dbch\af31505\loch\f4            row_number() over(partition by a.bene_id order by a.clm_dt) as RowNum
\par \hich\af4\dbch\af31505\loch\f4 from IN_rectum2_4trt a left join IN_rectum2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_surg and a.Drug_category in ('Fluorouracil', 'FLUOROURACIL'))
\par \tab 
\par ---
\par \hich\af4\dbch\af31505\loch\f4 , IN_fudays_piv as (SELECT distinct bene_ID,      
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=1 then clm_dt end) as fu1, 
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=2 then clm_dt end) as fu2, 
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=3 then clm_dt end) as fu3,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=4 then clm_dt end) as fu4,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=5 then clm_dt end) as fu5,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=6 then clm_dt end) as fu6,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=7 then clm_dt end) as fu7
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_fudays group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 , in_all as (select distinct a.bene_ID, a.Diag_Start_Date, a.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Capecitabine_fl, F\hich\af4\dbch\af31505\loch\f4 luorouracil_fl, Oxaliplatin_fl, Radiation_fl, Pump_fl, alldrugs,
\par \hich\af4\dbch\af31505\loch\f4              radiation_fr, first_rad, last_rad, surg_dt, first_cap, first_ox 
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4  , rad7, fu1, fu2, fu3, fu4, fu5, fu6, fu7
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum2_4trt_b a left join IN_fudays_piv f on a.bene_id = f.bene_id)
\par \tab \tab \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4  
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select top 5 * from in_all;\tab \tab \tab \tab \tab \tab \tab  
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /************
\par 
\par \hich\af4\dbch\af31505\loch\f4 ** flag pump related codes in all the claims data;
\par \hich\af4\dbch\af31505\loch\f4 data tocheck_allclms; set tocheck_allclms;
\par \hich\af4\dbch\af31505\loch\f4 if hcpcs_cd in ('96416', '96425', '96521', '96522', 'E0779', 'E0781', 'E0782', 'E0783', 'E0791',
\par \hich\af4\dbch\af31505\loch\f4 'E0776', 'A4221', 'A4222') 
\par \hich\af4\dbch\af31505\loch\f4 then pump_related = 1; run;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ********************/
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_check as
\par \hich\af4\dbch\af31505\loch\f4 (select bene_id, trtinit_dt, surg_dt,
\par \hich\af4\dbch\af31505\loch\f4   (case when alldrugs = 2 and radiation_fr > 6 and radiation_fl = 1 and Capecitabine_fl = 1  then '32022'
\par \hich\af4\dbch\af31505\loch\f4       
\par \hich\af4\dbch\af31505\loch\f4       when alldrugs = 2 and radiation_fr > 6 and Pump_fl = 1 and radiation_fl = 1 and Fluorouracil_fl = 1 and 
\par \hich\af4\dbch\af31505\loch\f4       ((fu1 between first_rad and last_rad) or (fu2 betwe\hich\af4\dbch\af31505\loch\f4 en first_rad and last_rad) or (fu3 between first_rad and last_rad) or (fu4 between first_rad and last_rad) or 
\par \hich\af4\dbch\af31505\loch\f4        (fu5 between first_rad and last_rad) or (fu6 between first_rad and last_rad) or (fu7 between first_rad and last_rad)) then '32023'
\par \hich\af4\dbch\af31505\loch\f4       when alldrugs = 2 and radiation_fr > 6 and Pump_fl <> 1 and radiation_fl = 1 and Fluorouracil_fl = 1 and
\par \hich\af4\dbch\af31505\loch\f4       ((fu1 between first_rad and last_rad) or (fu2 between first_rad and last_rad) or (fu3 between first_rad and last_rad) or (fu4 between first_rad an\hich\af4\dbch\af31505\loch\f4 d last_rad) or 
\par \hich\af4\dbch\af31505\loch\f4        (fu5 between first_rad and last_rad) or (fu6 between first_rad and last_rad) or (fu7 between first_rad and last_rad)) then '32024'
\par \tab \hich\af4\dbch\af31505\loch\f4   
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 1 and radiation_fr > 0 and radiation_fr <= 6 then '32025'
\par \hich\af4\dbch\af31505\loch\f4  
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 then '32026'
\par \hich\af4\dbch\af31505\loch\f4       when alldrugs = 2 and Capecitabine_fl = 1 and Oxaliplatin_fl = 1 then '32027'
\par \hich\af4\dbch\af31505\loch\f4       when alldrugs = 1 and Fluorouracil_fl = 1 then '32028'
\par \hich\af4\dbch\af31505\loch\f4       when alldrugs = 1 and Capecitabine_fl = 1 then '32029'
\par \hich\af4\dbch\af31505\loch\f4  
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 3 and radiation_fr <= 6 and radiation_fl = 1 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 
\par \tab \hich\af4\dbch\af31505\loch\f4        and (fu1 > last_rad and f\hich\af4\dbch\af31505\loch\f4 irst_ox > last_rad) then '32030'
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 3 and radiation_fr <= 6 and radiation_fl = 1 and Capecitabine_fl = 1 and Oxaliplatin_fl = 1 
\par \hich\af4\dbch\af31505\loch\f4            and (first_ox > last_rad) then '32031' 
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and radiation_fr <= 6 and radiation_fl = 1 and Fluorouracil_fl = 1
\par \tab \hich\af4\dbch\af31505\loch\f4        and (fu1 > last_rad) then '32032'
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and radiation_fr <= 6 and radiation_fl = 1 and Capecitabine_fl = 1 
\par \tab \hich\af4\dbch\af31505\loch\f4         then '32033'
\par \hich\af4\dbch\af31505\loch\f4       when alldrugs is NULL or alldrugs = 0                       then 0 --\hich\af4\dbch\af31505\loch\f4 - no regimens
\par \hich\af4\dbch\af31505\loch\f4         else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all
\par \hich\af4\dbch\af31505\loch\f4 ) 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Rectum2_trts
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt, trtreg from
\par \hich\af4\dbch\af31505\loch\f4 IN_check where surg_dt is not NULL and trtinit_dt is not null and (surg_dt >= trtinit_dt) 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- select distinct trtreg, count (distinct bene_ID) as benes from IN_check group by trtreg
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- select distinct trtreg, count (distinct bene_ID) as benes from IN_check 
\par \hich\af4\dbch\af31505\loch\f4 -- where surg_dt is not NULL and trtinit_dt is not null and (surg_dt >= trtinit_dt) group by trtreg
\par 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Pancreas1 *******************\hich\af4\dbch\af31505\loch\f4 ******************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Pancreas1_trts_f (\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index p on IN_Pancreas1_trts_f;
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Pancreas1_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAPECITABINE',\tab 'ERLOTINIB HCL', 'FLUOROURACIL',\tab 'GEMCITABINE HCL', 'IRINOTECAN HCL', 
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'LEUCOVORIN CALCIUM', 'OXALIPLATIN')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inne\hich\af4\dbch\af31505\loch\f4 r join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Pancreas1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join FFS_OPR as b\tab on a.bene_id = b.\hich\af4\dbch\af31505\loch\f4 bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Pancreas1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Pancreas1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner \hich\af4\dbch\af31505\loch\f4 join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Pancreas1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_\hich\af4\dbch\af31505\loch\f4 code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Pancreas1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Pancreas1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_D\hich\af4\dbch\af31505\loch\f4 ate, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Pancreas1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN\hich\af4\dbch\af31505\loch\f4 _Panc_elig_f as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Pancreas1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Panc_elig_f as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_pr\hich\af4\dbch\af31505\loch\f4 oc_dt >= Diag_Start_Date)) and c.Pancreas1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Pancreas1_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category fro\hich\af4\dbch\af31505\loch\f4 m IN_Pancreas1_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_\hich\af4\dbch\af31505\loch\f4 fu, clm_dt, Drug_category from IN_Pancreas1_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Pancreas1_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Pancreas1_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cisplatin') then 1 else 0 end) as Cisplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Docetaxel') then 1 else 0 end) as Docetaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Erlotinib', 'ERLOTINIB HCL') then 1 else 0 end) as Erlotinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case w\hich\af4\dbch\af31505\loch\f4 hen Drug_category in ('Gemcitabine', 'GEMCITABINE HCL') then 1 else 0 end) as Gemcitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Irinotecan', 'IRINOTECAN HCL') then 1 else 0 end) as Irinotecan_fr
\par \hich\af4\dbch\af31505\loch\f4 --, sum(case when Drug_category in ('Leucovorin', 'LEUCOVORIN CALCIUM') then 1 else 0 end) as Leucovorin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Nabpaclitaxel') then 1 else 0 end) as Nabpaclitaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Pancreas1_\hich\af4\dbch\af31505\loch\f4 4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cisplatin_fr >= 1 then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Docetaxel_fr >= 1 then 1 else 0 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Erlotinib_fr >= 1 then 1 else 0 end) as Erlotinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Gemcitabine_fr >= 1 then 1 else 0 end) as Gemcitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Irinotecan_fr >= 1 then 1 else 0 end) as Irinotecan_fl
\par \hich\af4\dbch\af31505\loch\f4 --,(case when Leucovorin_fr >= 1 then 1 else 0 end) as Leucovorin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Nabpaclitaxel_fr >= 1 then 1 \hich\af4\dbch\af31505\loch\f4 else 0 end) as Nabpaclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Oxaliplatin_fr >= 1 then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Pancreas1_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Pancreas1_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \hich\af4\dbch\af31505\loch\f4    Fluorouracil_fl, --Leucovorin_fl, 
\par \hich\af4\dbch\af31505\loch\f4    Capecitabine_fl, Oxaliplatin_fl, Irinotecan_fl, Gemcitabine_fl, 
\par \hich\af4\dbch\af31505\loch\f4    Nabpaclitaxel_fl, Docetaxel_fl, Cisplatin_fl, Erlotinib_fl,
\par \hich\af4\dbch\af31505\loch\f4    Fluorouracil_fr, --Leucovorin_fr, 
\par \hich\af4\dbch\af31505\loch\f4    Capecitabine_fr, Oxaliplatin_fr, Irinotecan_fr, Gemcitabine_fr,
\par \hich\af4\dbch\af31505\loch\f4    Nabpaclitax\hich\af4\dbch\af31505\loch\f4 el_fr, Docetaxel_fr, Cisplatin_fr, Erlotinib_fr
\par \hich\af4\dbch\af31505\loch\f4  \tab from IN_Panc_elig_f as a left join IN_Pancreas1_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_Pancreas1_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab Fluorouracil_fl, Leucovorin_fl, Capecitabine_fl, Oxaliplatin_fl, Irinotecan_fl, Gemcitabine_fl, 
\par \hich\af4\dbch\af31505\loch\f4  --  Nabpaclitaxel_fl, Docetaxel_fl, Cisplatin_fl, Erlotinib_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Pancreas1_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by Fluorouracil_fl, Leucovorin_fl, Capecitabine_fl, Oxaliplatin_fl, Irinotecan_fl, Gemcitabine_fl, 
\par \hich\af4\dbch\af31505\loch\f4 --   Nabpaclitaxel_fl, Docetaxel_fl, Cisplatin_fl, Erlotinib_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_pancreas1_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Pancreas1_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- 1699 benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_pancreas1_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Pancreas1_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Capecitabine', 'CAPECITAB\hich\af4\dbch\af31505\loch\f4 INE') then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cisplatin') then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Docetaxel') then 1 else 0 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Erlotinib', 'ERLOTINIB HCL') then 1 else 0 end) as Erlotinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Gemcitabine', 'GEMCITABINE HCL') then 1 else 0 end) as Gemcitabine\hich\af4\dbch\af31505\loch\f4 _fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Irinotecan', 'IRINOTECAN HCL') then 1 else 0 end) as Irinotecan_fl
\par \hich\af4\dbch\af31505\loch\f4 --, max(case when Drug_category in ('Leucovorin', 'L\hich\af4\dbch\af31505\loch\f4 EUCOVORIN CALCIUM') then 1 else 0 end) as Leucovorin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Nabpaclitaxel') then 1 else 0 end) as Nabpaclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Pancreas1_4trt a left join IN_pancreas1_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_pancreas1_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Dia\hich\af4\dbch\af31505\loch\f4 g_Start_Date, b.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Fluorouracil_fl, --Leucovorin_fl, 
\par \tab \hich\af4\dbch\af31505\loch\f4          Capecitabine_fl, Oxaliplatin_fl, Irinotecan_fl, Gemcitabine_fl, 
\par \hich\af4\dbch\af31505\loch\f4              Nabpaclitaxel_fl, Docetaxel_fl, Cisplatin_fl, Erlotinib_fl, 
\par \hich\af4\dbch\af31505\loch\f4              (Fluorouracil_fl + --Leucovorin_fl, 
\par \tab \hich\af4\dbch\af31505\loch\f4          Capecitabine_fl + Oxaliplatin_fl + Irinotecan_fl + Gemcitabine_fl + 
\par \hich\af4\dbch\af31505\loch\f4              Nabpaclitaxel_fl + Docetaxel_fl + Cisplatin_fl + Erlotinib_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_Panc_elig_f a left join IN_Pancreas1_60d b on a.bene_id = b.bene\hich\af4\dbch\af31505\loch\f4 _id)
\par \hich\af4\dbch\af31505\loch\f4                              
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct Fluorouracil_fl, Capecitabine_fl, Oxaliplatin_fl, Irinotecan_fl, Gemcitabine_fl, 
\par \hich\af4\dbch\af31505\loch\f4    Nabpaclitaxel_fl, Docetaxel_fl, Cisplatin_fl, Erlotinib_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4    from IN_all
\par \hich\af4\dbch\af31505\loch\f4    group by Fluorouracil_fl, Capecitabine_fl, Oxaliplatin_fl, Irinotecan_fl, Gemcitabine_fl, 
\par \hich\af4\dbch\af31505\loch\f4    Nabpaclitaxel_fl, Docetaxel_fl, Cisplatin_fl, Erlotinib_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Pancreas1_trts_f\tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab 
\par \hich\af4\dbch\af31505\loch\f4   (case when alldrugs = 2 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1                                then 30031\tab \tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Oxaliplatin_fl\tab = 1\tab \tab \tab \tab \tab             then 30032
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 3 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 and Irinotecan_fl = 1          then 30023\tab \tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Gemcitabine_fl = 1\tab \tab \tab \tab                                         then 30028
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Gemcitabine_fl\tab = 1 and Nabpaclitaxel_fl = 1              \hich\af4\dbch\af31505\loch\f4               then 30025\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Gemcitabine_fl = 1                                then 30029\tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Capecitabine_fl = 1 and Gemcitabine_fl\tab = 1 and\tab Docetaxel_fl =1         then 30030\tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Gemcitabine_fl\tab = 1 and\tab Cisplatin_fl = 1\tab                             then 30026
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 --when Gemcitabine_fl\tab = 1 and Cisplatin_fl = 1\tab then 9
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Gemcitabine_fl\tab = 1 and Erlotinib_fl = 1                                then 3002\hich\af4\dbch\af31505\loch\f4 7
\par \hich\af4\dbch\af31505\loch\f4 --        when Fluorouracil_fl = 1 and Leucovorin_fl\tab \tab Oxaliplatin_fl\tab Irinotecan_fl then\tab 11\tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4         else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all; 
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_check
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Colon1 ****************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Colon1_trts (\tab \tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Colon1_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_PDE as b on a.bene_id =\hich\af4\dbch\af31505\loch\f4  b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL',\tab 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM',
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Colon1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Colon1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_DM\hich\af4\dbch\af31505\loch\f4 E as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Colon1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Dia\hich\af4\dbch\af31505\loch\f4 g_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Colon1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Colon1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b\hich\af4\dbch\af31505\loch\f4 .LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Colon1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Colon1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as\hich\af4\dbch\af31505\loch\f4  clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Colon1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_elig as a inner join MC_FFS\hich\af4\dbch\af31505\loch\f4 _OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Colon1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Colon1_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_HOSP\hich\af4\dbch\af31505\loch\f4 C) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Colon1_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Colon1_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BE\hich\af4\dbch\af31505\loch\f4 NE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Bevacizumab', 'BEVACIZUMAB') then 1 else 0 end) as Bevacizumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cetuximab', 'CETUXIMAB') then 1 else 0 end) as Cetuximab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ipilimumab') then 1 else 0 end) as Ipilimumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when D\hich\af4\dbch\af31505\loch\f4 rug_category in ('Irinotecan', 'IRINOTECAN HCL') then 1 else 0 end) as Irinotecan_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Lapatinib') then 1 else 0 end) as Lapatinib_fr
\par \hich\af4\dbch\af31505\loch\f4 --, sum(case when Drug_category in ('Leucovorin', 'LEUCOVORIN CALCIUM') then 1 else 0 end) as Leucovorin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Nivolumab', 'NIVOLUMAB') then 1 else 0 end) as Nivolumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Panitumumab', 'PANITUMUMAB') then 1 else 0 end) as Panitumumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Pembrolizumab') then 1 else 0 end) as Pembrolizumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when D\hich\af4\dbch\af31505\loch\f4 rug_category in ('Pertuzumab') then 1 else 0 end) as Pertuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Trastuzumab') then 1 else 0 end) as Trastuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Bevacizumab_fr >= 1 then 1 else 0 end) as Bevacizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cetuximab_fr >= 1 then 1 else 0 end) as Cetuximab_f\hich\af4\dbch\af31505\loch\f4 l
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ipilimumab_fr >= 1 then 1 else 0 end) as Ipilimumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Irinotecan_fr >= 1 then 1 else 0 end) as Irinotecan_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lapatinib_fr >= 1 then 1 else 0 end) as Lapatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 --,(case when Leucovorin_fr >= 1 then 1 else 0 end) as Leucovorin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Nivolumab_fr >= 1 then 1 else 0 end) as Nivolumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Oxaliplatin_fr >= 1 then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Panitumumab_fr >= 1 then \hich\af4\dbch\af31505\loch\f4 1 else 0 end) as Panitumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pembrolizumab_fr >= 1 then 1 else 0 end) as Pembrolizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pertuzumab_fr >= 1 then 1 else 0 end) as Pertuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Trastuzumab_fr >= 1 then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Colon1_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \hich\af4\dbch\af31505\loch\f4       Fluorouracil_fl, Capecitabine_fl, --Leucovorin_fl, 
\par \hich\af4\dbch\af31505\loch\f4       Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4       Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4       Trastuzumab_fl,
\par \hich\af4\dbch\af31505\loch\f4       Fluorouracil_fr, Capecitabine_fr, --Leucovorin_fr, 
\par \hich\af4\dbch\af31505\loch\f4       Irinotecan_fr, Ox\hich\af4\dbch\af31505\loch\f4 aliplatin_fr, Bevacizumab_fr,
\par \hich\af4\dbch\af31505\loch\f4       Cetuximab_fr, Panitumumab_fr, Nivolumab_fr, Pembrolizumab_fr, Ipilimumab_fr, Pertuzumab_fr, Lapatinib_fr,
\par \hich\af4\dbch\af31505\loch\f4       Trastuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4    from IN_Colon1_elig as a left join IN_Colon1_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_Colon1_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab       Fluorouracil_fl, Capecitabine_fl, Leucovorin_fl, Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, \hich\af4\dbch\af31505\loch\f4 Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Trastuzumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Colon1_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by       Fluorouracil_fl, Capecitabine_fl, Leucovorin_fl, Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Trastuzumab_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_Colon1_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Colon1_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- 1699 benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_Colon1_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days c\hich\af4\dbch\af31505\loch\f4 laims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Colon1_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Bevacizumab', 'BEVACIZUMAB') then 1 else 0 end) as Bevacizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cetuximab', 'CETUXIMAB') then 1 else 0 end) as Cetuximab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 e\hich\af4\dbch\af31505\loch\f4 lse 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ipilimumab') then 1 else 0 end) as Ipilimumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Irinotecan', 'IRINOTECAN HCL') then 1 else 0 end) as Irinotecan_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Lapatinib') then 1 else 0 end) as Lapatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 --, max(case when Drug_category in ('Leucovorin', 'LEUCOVORIN CALCIUM') then 1 else 0 end) as Leucovorin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Nivolumab', 'NIVOLUMAB') then 1 else 0 end) as Nivolumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Panitumumab', 'PANITUMUMAB') then 1 else 0 end) as Panitumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Pembrolizumab') then 1 else 0 end) as Pembrolizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Pertuzumab') then 1 else 0 end) as Pertuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Trastuzumab') then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Colon1_4trt a left join IN_Colon1_trtinit \hich\af4\dbch\af31505\loch\f4 b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Colon1_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Fluorouracil_fl, Capecitabine_fl, --Leucovorin_fl, 
\par \tab \hich\af4\dbch\af31505\loch\f4          Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl, Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4              Trastuzumab_fl,
\par \hich\af4\dbch\af31505\loch\f4              (Fluorourac\hich\af4\dbch\af31505\loch\f4 il_fl+ Capecitabine_fl+ --Leucovorin_fl+ 
\par \tab \hich\af4\dbch\af31505\loch\f4          Irinotecan_fl+ Oxaliplatin_fl+ Bevacizumab_fl+ Cetuximab_fl+ Panitumumab_fl+ Nivolumab_fl+ Pembrolizumab_fl+ Ipilimumab_fl+ Pertuzumab_fl+ Lapatinib_fl+
\par \hich\af4\dbch\af31505\loch\f4              Trastuzumab_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_Colon1_elig a left join IN_Colon1_60d b on a.bene_id = b.bene_id)
\par \hich\af4\dbch\af31505\loch\f4                              
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab       Fluorouracil_fl, Capecitabine_fl, Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pem\hich\af4\dbch\af31505\loch\f4 brolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Trastuzumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_all 
\par \hich\af4\dbch\af31505\loch\f4 --group by       Fluorouracil_fl, Capecitabine_fl, Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Trastuzumab_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Colon1_trts\tab \tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4   (case 
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Fluorouracil_fl = 1\tab \tab \tab                 then 19056
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Fluorouracil_fl = 1 and Bevacizumab_fl = 1\tab then 19063
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Capecitabine_fl = 1\tab \tab \tab                 then 19064
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Bevacizumab_fl = 1\tab then 19065
\par \hich\af4\dbch\af31505\loch\f4 when al\hich\af4\dbch\af31505\loch\f4 ldrugs = 2 and Capecitabine_fl = 1 and Oxaliplatin_fl = 1\tab then 19054
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Capecitabine_fl = 1 and Oxaliplatin_fl = 1 and Bevacizumab_fl = 1\tab then 19055
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Cetuximab_fl = 1 \tab \tab \tab                     then 19066
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab \tab then 19057
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab and Bevacizumab_fl = 1\tab then 19058
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab and Cetuximab_fl = 1\tab then 19059
\par \hich\af4\dbch\af31505\loch\f4 w\hich\af4\dbch\af31505\loch\f4 hen alldrugs = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab and Panitumumab_fl = 1\tab then 19060
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1\tab                     then 19050
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 and Bevacizumab_fl = 1\tab then 19051
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 and Cetuximab_fl = 1   then 19052
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 and Panitumumab_fl = 1\tab then 19053
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and \hich\af4\dbch\af31505\loch\f4 Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab  and Oxaliplatin_fl = 1\tab then 19061
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 4 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab  and Oxaliplatin_fl = 1 and Bevacizumab_fl = 1\tab then 19062
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Panitumumab_fl = 1\tab \tab \tab                 then 19067
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Nivolumab_fl = 1\tab \tab \tab                     then 19068
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Pembrolizumab_fl = 1\tab \tab \tab                 then 19069
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Nivolumab_fl = 1 \tab and Ipilimumab_fl = 1 \tab \tab then 19070
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Pertuzumab_fl = 1 and Trastuzumab_fl = 1\tab \tab then 19162
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Lapatinib_fl = 1\tab and Trastuzumab_fl = 1\tab \tab then 19163
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4         else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \hich\af4\dbch\af31505\loch\f4  
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_check
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /***********************\hich\af4\dbch\af31505\loch\f4 ********* Rectum1 ***************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Rectum1_trts (\tab \tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab \tab \tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Rectum1_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL',\tab 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM',
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rec\hich\af4\dbch\af31505\loch\f4 tum1_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                          \tab \tab      inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join FFS_OPR as b\tab o\hich\af4\dbch\af31505\loch\f4 n a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes du\hich\af4\dbch\af31505\loch\f4 ring fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Rectum1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a\hich\af4\dbch\af31505\loch\f4 .bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Rectum1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date\hich\af4\dbch\af31505\loch\f4 , end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt\hich\af4\dbch\af31505\loch\f4  as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Rectum1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Rectum1_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_St\hich\af4\dbch\af31505\loch\f4 art_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct b\hich\af4\dbch\af31505\loch\f4 ene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Rectum1_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Rectum1_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Bevacizumab', 'BEVACIZUMAB') then 1 else 0 end) as Bevacizumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(c\hich\af4\dbch\af31505\loch\f4 ase when Drug_category in ('Cetuximab', 'CETUXIMAB') then 1 else 0 end) as Cetuximab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ipilimumab') then 1 else 0 end) as Ipilimumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Irinotecan', 'IRINOTECAN HCL') then 1 else 0 end) as Irinotecan_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Lapatinib') then 1 else 0 end) as Lapatinib_fr
\par \hich\af4\dbch\af31505\loch\f4 --, sum(case when Drug_category in ('Leucovorin', 'L\hich\af4\dbch\af31505\loch\f4 EUCOVORIN CALCIUM') then 1 else 0 end) as Leucovorin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Nivolumab', 'NIVOLUMAB') then 1 else 0 end) as Nivolumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Panitumumab', 'PANITUMUMAB') then 1 else 0 end) as Panitumumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Pembrolizumab') then 1 else 0 end) as Pembrolizumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Pertuzumab') then 1 else 0 end) as\hich\af4\dbch\af31505\loch\f4  Pertuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Trastuzumab') then 1 else 0 end) as Trastuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Bevacizumab_fr >= 1 then 1 else 0 end) as Bevacizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cetuximab_fr >= 1 then 1 else 0 end) as Cetuximab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ipilimumab_fr >= 1 then 1 else 0 end) as Ipilimumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Irinotecan_fr >= 1 then 1 else 0 end) as Irinotecan_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lapatinib_fr >= 1 then 1 else 0\hich\af4\dbch\af31505\loch\f4  end) as Lapatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 --,(case when Leucovorin_fr >= 1 then 1 else 0 end) as Leucovorin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Nivolumab_fr >= 1 then 1 else 0 end) as Nivolumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Oxaliplatin_fr >= 1 then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Panitumumab_fr >= 1 then 1 else 0 end) as Panitumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pembrolizumab_fr >= 1 then 1 else 0 end) as Pembrolizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Pertuzumab_fr >= 1 then 1 else 0 end) as Pertuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Trastuzumab_fr >= 1 then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_R\hich\af4\dbch\af31505\loch\f4 ectum1_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Rectum1_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \hich\af4\dbch\af31505\loch\f4       Fluorouracil_fl, Capecitabine_fl, --Leucovorin_fl, 
\par \hich\af4\dbch\af31505\loch\f4       Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4       Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4       Trastuzumab_fl,       Fluorouracil_fr, Capecitabine_fr, -- Leucovorin_fr, 
\par \hich\af4\dbch\af31505\loch\f4       Irinotecan_fr, Oxaliplatin_fr, Bevacizumab_fr,
\par \hich\af4\dbch\af31505\loch\f4       Cetuximab_fr, Panitumumab_fr, Nivolumab_fr, Pembrolizumab_fr, Ipilimumab_fr, Pertuzumab_fr, Lapatinib_fr,
\par \hich\af4\dbch\af31505\loch\f4       Trastuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4    from IN_Rectum1_elig as a left join IN_Rectum1_drugflag as b on a.bene_id = b\hich\af4\dbch\af31505\loch\f4 .bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_Rectum1_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab       Fluorouracil_fl, Capecitabine_fl , Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Trastuzumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Rectum1_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by       Fluorouracil_fl, Capecitabine_fl, Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Cet\hich\af4\dbch\af31505\loch\f4 uximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --      Trastuzumab_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_Rectum1_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Rectum1_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- 1699 benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_Rectum1_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Rectum1_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Bevacizumab', 'BEVACIZUMAB') then 1 else 0 end) as Bevacizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Dr\hich\af4\dbch\af31505\loch\f4 ug_category in ('Cetuximab', 'CETUXIMAB') then 1 else 0 end) as Cetuximab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ipilimumab') then 1 else 0 end) as Ipilimumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Irinotecan', 'IRINOTECAN HCL') then 1 else 0 end) as Irinotecan_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Lapatinib') then 1 else 0 end) as Lapatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 --, max(case when Drug_category in ('Leucovorin', 'LEUCOVORIN C\hich\af4\dbch\af31505\loch\f4 ALCIUM') then 1 else 0 end) as Leucovorin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Nivolumab', 'NIVOLUMAB') then 1 else 0 end) as Nivolumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Panitumumab', 'PANITUMUMAB') then 1 else 0 end) as Panitumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Pembrolizumab') then 1 else 0 end) as Pembrolizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Pertuzumab') then 1 else 0 end) as Pertuzumab\hich\af4\dbch\af31505\loch\f4 _fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Trastuzumab') then 1 else 0 end) as Trastuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_4trt a left join IN_Rectum1_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt )
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct \tab       Fluorouracil_fl, Capecitabine_fl , Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4       Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4       Trastuzumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 from IN_Rectum1_60d
\par \hich\af4\dbch\af31505\loch\f4 group by       Fluorouracil_fl, Capecitabine_fl, Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4       Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4       Trastuzumab_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Rectum1_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, \hich\af4\dbch\af31505\loch\f4 b.trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4          Fluorouracil_fl, Capecitabine_fl, --Leucovorin_fl, 
\par \tab \hich\af4\dbch\af31505\loch\f4          Irinotecan_fl, Oxaliplatin_fl, Bevacizumab_fl,
\par \hich\af4\dbch\af31505\loch\f4              Cetuximab_fl, Panitumumab_fl, Nivolumab_fl, Pembrolizumab_fl, Ipilimumab_fl, Pertuzumab_fl, Lapatinib_fl,
\par \hich\af4\dbch\af31505\loch\f4              Trastuzumab_fl,
\par \hich\af4\dbch\af31505\loch\f4              (Fluorouracil_fl+ Capecitabine_fl+ --Leucovorin_fl+ 
\par \tab \hich\af4\dbch\af31505\loch\f4          Irinotecan_fl+ Oxaliplatin_fl+ Bevacizumab_fl+ Cetuximab_fl+ Panitumumab_fl+ Nivolumab_fl+ Pembrolizumab_fl+ Ipilimumab_fl+ Pertuzumab_fl+ Lapatinib_fl+
\par \hich\af4\dbch\af31505\loch\f4   \hich\af4\dbch\af31505\loch\f4            Trastuzumab_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_Rectum1_elig a left join IN_Rectum1_60d b on a.bene_id = b.bene_id)
\par \hich\af4\dbch\af31505\loch\f4                              
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Rectum1_trts\tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab \tab 
\par \hich\af4\dbch\af31505\loch\f4   (case 
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Fluorouracil_fl = 1\tab \tab \tab                 then 32086
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Fluorouracil_fl = 1 and Bevacizumab_fl = 1\tab then 32093
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Capecitabine_fl = 1\tab \tab \tab                 then 32094
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Bevacizumab_fl = 1\tab then 32095
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Capecitabine_fl = 1 and Oxaliplatin_fl = 1\tab then 32084
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Capecitabine_fl = 1 and Oxaliplatin_fl = 1 and Bevacizumab_fl = 1\tab then 32085
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Cetuximab_fl = 1 \tab \tab \tab                     then 32096
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab \tab then 32087
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab and Bevacizumab_fl = 1\tab then 32088
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs \hich\af4\dbch\af31505\loch\f4 = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab and Cetuximab_fl = 1\tab then 32089
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab and Panitumumab_fl = 1\tab then 32090
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1\tab                     then 32080
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 and Bevacizumab_fl = 1\tab then 32081
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 and Cetuximab_fl = 1   then 32082
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl \hich\af4\dbch\af31505\loch\f4 = 1 and Oxaliplatin_fl = 1 and Panitumumab_fl = 1\tab then 32083
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab  and Oxaliplatin_fl = 1\tab then 32091
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 4 and Fluorouracil_fl = 1 and Irinotecan_fl = 1\tab  and Oxaliplatin_fl = 1 and Bevacizumab_fl = 1\tab then 32092
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Panitumumab_fl = 1\tab \tab \tab                 then 32097
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Nivolumab_fl = 1\tab \tab \tab                     then 32098
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Pembrolizumab_fl = 1\tab \tab \tab                 then 32099
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = \hich\af4\dbch\af31505\loch\f4 2 and Nivolumab_fl = 1 \tab and Ipilimumab_fl = 1 \tab \tab then 32100
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Pertuzumab_fl = 1 and Trastuzumab_fl = 1\tab \tab then 32194
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Lapatinib_fl = 1\tab and Trastuzumab_fl = 1\tab \tab then 32195
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs is NULL or alldrugs = 0                      then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4         else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \hich\af4\dbch\af31505\loch\f4  
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_check
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********\hich\af4\dbch\af31505\loch\f4 ************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Lung10 ****************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 --'BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL', 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM', 'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB'
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Lung10_trts (\tab \tab \tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab \tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab \tab \tab \tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Lung10_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('AFATINIB DIMALEATE', 'BEVACIZUMAB', 'DACOMITINIB', 'ERLOTINIB HCL', 'GEFITINIB', 
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'OSIMERTINIB MESYLATE', 'RAMUCIRUMAB')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Lung10 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Lung10 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Sta\hich\af4\dbch\af31505\loch\f4 rt_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Lung10 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Lung10 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b\hich\af4\dbch\af31505\loch\f4 .REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Lung10 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, \hich\af4\dbch\af31505\loch\f4 b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Lung10 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 fro\hich\af4\dbch\af31505\loch\f4 m IN_Lung10_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Lung10 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id =\hich\af4\dbch\af31505\loch\f4  b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Lung10 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Lung10 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Lung10_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, c\hich\af4\dbch\af31505\loch\f4 lm_dt, Drug_category from IN_Lung10_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, \hich\af4\dbch\af31505\loch\f4 end_fu, clm_dt, Drug_category from IN_Lung10_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Lung10_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par -\hich\af4\dbch\af31505\loch\f4 ---- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Lung10_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Afatinib', 'AFATINIB','AFATINIB DIMALEATE') then 1 else 0 end) as Afatinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Bevacizumab', 'BEVACIZUMAB') then 1 else 0 end) as Bevacizumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Dacomitinib', 'DACOMITINIB') then 1 else 0 end) as Dacomitinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Erlotinib', 'ERLOTINIB','ERLOTINIB HCL') then 1 else 0 end) as Erlotinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Gefitinib', 'GEFITINIB') then 1 else 0 end) as Gefitinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Osimertinib', 'OSIMERTINIB','OSIMERTINIB MESYLATE') then 1 else 0 end) as Osimertinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ramucirumab', 'RAMUCIRUMAB') then 1 else 0 end) as Ramucirumab_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Afatinib_fr >= 1 then 1 \hich\af4\dbch\af31505\loch\f4 else 0 end) as Afatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Bevacizumab_fr >= 1 then 1 else 0 end) as Bevacizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Dacomitinib_fr >= 1 then 1 else 0 end) as Dacomitinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Erlotinib_fr >= 1 then 1 else 0 end) as Erlotinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Gefitinib_fr >= 1 then 1 else 0 end) as Gefitinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Osimertinib_fr >= 1 then 1 else 0 end) as Osimertinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ramucirumab_fr >= 1 then 1 else 0 end) as Ramucirumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Lung10_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \hich\af4\dbch\af31505\loch\f4     Afatinib_fl, Bevacizumab_fl, Dacomitinib_fl, Erlotinib_fl, Gefitinib_fl, Osimertinib_fl, Ramucirumab_fl,
\par \hich\af4\dbch\af31505\loch\f4     Afatinib_fr, Bevacizumab_fr, Dacomitinib_fr, Erlotinib_fr, Gefitinib_fr, Osimertinib_fr, Ramucirumab_fr
\par \hich\af4\dbch\af31505\loch\f4     from IN_Lung10_elig as a left join IN_Lung10_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_Lung10_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct Afatinib_fl, Bevacizuma\hich\af4\dbch\af31505\loch\f4 b_fl, Dacomitinib_fl, Erlotinib_fl, Gefitinib_fl, Osimertinib_fl, Ramucirumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_drugs 
\par \hich\af4\dbch\af31505\loch\f4 group by Afatinib_fl, Bevacizumab_fl, Dacomitinib_fl, Erlotinib_fl, Gefitinib_fl, Osimertinib_fl, Ramucirumab_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_Lung10_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Lung10_4trt wh\hich\af4\dbch\af31505\loch\f4 ere clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---  benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_Lung10_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Lung10_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Afatinib', 'AFATINIB','AFATINIB DIMALEATE') then 1 else 0 end) as Afatinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Bevacizumab', 'BEVACIZUMAB') then 1 else 0 end) as Bevacizumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Dacomitinib', 'DACOMITINIB') then 1 else 0 end) as Dacomitinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Erlotinib', 'ERLOTINIB','ERLOTINIB HCL') then 1 else 0 end) as Erlotinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Gefitinib', 'GEFITINIB') then 1 else 0 end) as Gefi\hich\af4\dbch\af31505\loch\f4 tinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Osimertinib', 'OSIMERTINIB','OSIMERTINIB MESYLATE') then 1 else 0 end) as Osimertinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ramucirumab', 'RAMUCIRUMAB') then 1 else 0 end) as Ramucirumab_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Lung10_4trt a left join IN_Lung10_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Lung10_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtini\hich\af4\dbch\af31505\loch\f4 t_dt,
\par \hich\af4\dbch\af31505\loch\f4               Afatinib_fl, Bevacizumab_fl, Dacomitinib_fl, Erlotinib_fl, Gefitinib_fl, Osimertinib_fl, Ramucirumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4              (Afatinib_fl+ Bevacizumab_fl+ Dacomitinib_fl+ Erlotinib_fl+ Gefitinib_fl+ Osimertinib_fl+ Ramucirumab_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_Lung10_elig a left join IN_Lung10_60d b on a.bene_id = b.bene_id)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- select distinct Afatinib_fl, Bevacizumab_fl, Dacomitinib_fl, Erlotinib_fl, Gefitinib_fl, Osimertinib_fl, Ramucirumab_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 -- from IN_all
\par \hich\af4\dbch\af31505\loch\f4 -- gr\hich\af4\dbch\af31505\loch\f4 oup by Afatinib_fl, Bevacizumab_fl, Dacomitinib_fl, Erlotinib_fl, Gefitinib_fl, Osimertinib_fl, Ramucirumab_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Lung10_trts\tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab 
\par \hich\af4\dbch\af31505\loch\f4   (case when alldrugs = 1 and Erlotinib_fl = 1 \tab \tab     then 28003
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 1 and Afatinib_fl = 1 \tab \tab \tab then 28001
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 1 and Gefitinib_fl = 1\tab \tab \tab then 28004
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 1 and Osimertinib_fl = 1\tab \tab then 28005
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 1 and Dacomitinib_fl = 1\tab \tab then 28002
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 2 and Erlotinib_fl = 1 and\tab Bevacizumab_fl = 1\tab then 28168
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs = 2 and Erlotinib_fl = 1 and\tab Ramucirumab_fl = 1\tab then 28169
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs is NULL or alldrugs = \hich\af4\dbch\af31505\loch\f4 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4         else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \hich\af4\dbch\af31505\loch\f4  
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_check
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** CLL *******************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 --'BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL', 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM', 'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB'
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_CLL_trts (\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4  with IN_CLL_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig\hich\af4\dbch\af31505\loch\f4  as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('ACALABRUTINIB', 'BENDAMUSTINE HCL', 'CHLORAMBUCIL', 'IBRUTINIB', 'METHYLPREDNISOLONE', 
\par \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4     'METHYLPREDNISOLONE SOD SUCC/PF', 'OBINUTUZUMAB', 'RITUXIMAB', 'VENETOCLAX')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_\hich\af4\dbch\af31505\loch\f4 elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.CLL = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.CLL = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_D\hich\af4\dbch\af31505\loch\f4 T as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.CLL = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a i\hich\af4\dbch\af31505\loch\f4 nner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.CLL = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV\hich\af4\dbch\af31505\loch\f4 _CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.CLL = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.CLL = 1   \hich\af4\dbch\af31505\loch\f4       \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.CLL = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_i\hich\af4\dbch\af31505\loch\f4 d
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.CLL = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_CLL_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = \hich\af4\dbch\af31505\loch\f4 c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.CLL = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_CLL_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4   \hich\af4\dbch\af31505\loch\f4   (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_CLL_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par -\hich\af4\dbch\af31505\loch\f4 ---- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_CLL_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Acalabrutinib', 'ACALABRUTINIB') then 1 else 0 end) as Acalabrutinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Bendamustine', 'BENDAMUSTINE','BENDAMUSTINE HCL') then 1 else 0 end) as Bendamustine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Chlorambucil', 'CHLORAMBUCIL') then 1 else 0 end) as Chlorambucil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ibrutinib', 'IBRUTINIB') then 1 else 0 end) as Ibrutinib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Methylprednisolone', 'METHYLPREDNISOLONE','METHYLPREDNISOLONE SOD SUCC/PF') then 1 else 0 end) as Methylprednisolone_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Obinutuzumab', 'OBINUTUZUMAB') then 1 else 0 end) as Obinutuzumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ofatumumab', 'OFATUMUMAB') then 1 else 0 end) as Ofatumumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Rituximab', 'RITUXIMAB') then 1 else 0 end) as Rituximab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Venetoclax', 'VENETOCLAX') then 1 else 0 end) as Venetoclax_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_CLL_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_drugflag as\hich\af4\dbch\af31505\loch\f4  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Acalabrutinib_fr >= 1 then 1 else 0 end) as Acalabrutinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Bendamustine_fr >= 1 then 1 else 0 end) as Bendamustine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Chlorambucil_fr >= 1 then 1 else 0 end) as Chlorambucil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ibrutinib_fr >= 1 then 1 else 0 end) as Ibrutinib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Methylprednisolone_fr >= 1 then 1 else 0 end) as Methylprednisolone_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Obinutuzumab_fr >= 1 then 1 else 0 end) as Obinutuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ofatumumab_fr >= 1 then 1 else 0 \hich\af4\dbch\af31505\loch\f4 end) as Ofatumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Rituximab_fr >= 1 then 1 else 0 end) as Rituximab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Venetoclax_fr >= 1 then 1 else 0 end) as Venetoclax_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_CLL_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_CLL_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \hich\af4\dbch\af31505\loch\f4     Acalabrutinib_fl, Bendamustine_fl, Chlorambucil_fl, Ibrutinib_fl, Methylprednisolone_fl, Obinutuzumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4     Ofatumumab_fl, Rituximab_fl, Venetoclax_fl,
\par \hich\af4\dbch\af31505\loch\f4     Acalabrutinib_fr, Bendamustine_fr, Chlorambucil_fr, Ibrutinib_fr, Methylprednisolone_fr, Obinutuzumab_fr, 
\par \hich\af4\dbch\af31505\loch\f4     Ofatumumab_fr, Rituximab_fr, Venetoclax_fr
\par \hich\af4\dbch\af31505\loch\f4     from IN_CLL_elig as a left join IN_CLL_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_CLL_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct     Acalabrutinib_fl, Bendamustine_fl, Chlorambucil_fl, Ibrutinib_fl, Methylprednisolone_fl, Obinutuzumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4 --    Ofatumumab_fl, Rituximab_fl, Venetoclax_fl, count (\hich\af4\dbch\af31505\loch\f4 distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_CLL_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by     Acalabrutinib_fl, Bendamustine_fl, Chlorambucil_fl, Ibrutinib_fl, Methylprednisolone_fl, Obinutuzumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4 --    Ofatumumab_fl, Rituximab_fl, Venetoclax_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_CLL_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_CLL_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                 \hich\af4\dbch\af31505\loch\f4             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---  benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_Lung10_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_CLL_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Acalabrutinib', 'ACALABRUTINIB') then 1 else 0 end) as Acalabrutinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Bendamustine', 'BENDAMUSTINE','BENDAMUSTINE HCL') then 1 else 0 end) as Bendamustine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Chlorambucil', 'CHLORAMBUCIL') then 1 else 0 end) as Chlorambucil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ibrutinib', 'IBRUTINIB') then 1 else 0 end) a\hich\af4\dbch\af31505\loch\f4 s Ibrutinib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Methylprednisolone', 'METHYLPREDNISOLONE','METHYLPREDNISOLONE SOD SUCC/PF') then 1 else 0 end) as Methylprednisolone_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Obinutuzumab', 'OBINUTUZUMAB') then 1 else 0 end) as Obinutuzumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ofatumumab', 'OFATUMUMAB') then 1 else 0 end) as Ofatumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Rituximab', 'RITUXIMAB') then 1 else 0 end) as Rituximab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Venetoclax\hich\af4\dbch\af31505\loch\f4 ', 'VENETOCLAX') then 1 else 0 end) as Venetoclax_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_CLL_4trt a left join IN_CLL_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_CLL_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt,
\par \hich\af4\dbch\af31505\loch\f4     Acalabrutinib_fl, Bendamustine_fl, Chlorambucil_fl, Ibrutinib_fl, Methylprednisolone_fl, Obinutuzumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4     Ofatumumab_fl, Rituximab_fl, Venetoclax_fl,
\par \hich\af4\dbch\af31505\loch\f4     (Acalabrutinib_fl+ Ben\hich\af4\dbch\af31505\loch\f4 damustine_fl+ Chlorambucil_fl+ Ibrutinib_fl+ --Methylprednisolone_fl+ 
\par \hich\af4\dbch\af31505\loch\f4     \tab Obinutuzumab_fl+ Ofatumumab_fl+ Rituximab_fl+ Venetoclax_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_CLL_elig a left join IN_CLL_60d b on a.bene_id = b.bene_id)
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct     Acalabrutinib_fl, Bendamustine_fl, Chlorambucil_fl, Ibrutinib_fl, Methylprednisolone_fl, Obinutuzumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4     Ofatumumab_fl, Rituximab_fl, Venetoclax_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 from IN_all
\par \hich\af4\dbch\af31505\loch\f4 group by     Acalabrutinib_fl, Bendamustine_fl, Chlorambucil_fl, Ibrutinib_fl, Methylprednisolone_fl, Obinutuzumab_fl, 
\par \hich\af4\dbch\af31505\loch\f4     Ofatumumab_fl, Rituximab_fl, Venetoclax_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_CLL_trts\tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab \tab 
\par \hich\af4\dbch\af31505\loch\f4   (case 
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Obinutuzumab_fl = 1 and Chlorambucil_fl = 1\tab \tab then 17006
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Ibrutinib_fl = 1\tab \tab \tab                         then 17001
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Ofatumumab_fl = 1\tab and Chlorambucil_fl = 1\tab \tab     then 17007
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Rituximab_fl = 1 an\hich\af4\dbch\af31505\loch\f4 d Chlorambucil_fl = 1\tab \tab \tab then 17008 
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Bendamustine_fl = 1\tab \tab \tab                     then 17016
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Rituximab_fl =1 and Bendamustine_fl = 1\tab \tab \tab then 17005
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Obinutuzumab_fl = 1 \tab \tab \tab                     then 17011
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Chlorambucil_fl = 1\tab \tab \tab                     then 17012
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Rituximab_fl = 1 \tab \tab                             then 17013
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Obinutuzumab_fl = 1 and Bendamustine_fl = 1\tab \tab then 17003
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2\hich\af4\dbch\af31505\loch\f4  and Ofatumumab_fl = 1\tab and Bendamustine_fl = 1\tab \tab     then 17004
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Rituximab_fl = 1 and Methylprednisolone_fl = 1\tab then 17009
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Obinutuzumab_fl = 1 and Venetoclax_fl = 1\tab \tab \tab then 17002
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Obinutuzumab_fl = 1 and Ibrutinib_fl = 1\tab         then 17010
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Acalabrutinib_fl = 1\tab \tab \tab                     then 17108
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Obinutuzumab_fl = 1 and Acalabrutinib_fl =1\tab \tab then 17109
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Venetoclax_fl = 1                                 then 888 -- non recommended regimen
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Ibrutinib_fl = 1 and Rituximab_fl = 1             then 888 -- non recommended regimen
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Venetoclax_fl = 1 and Rituximab_fl = 1             then 888 -- non recommended regimen
\par 
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4   else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \hich\af4\dbch\af31505\loch\f4  
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(dis\hich\af4\dbch\af31505\loch\f4 tinct bene_ID) as benes from IN_check
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Gallbladder ***********************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 --'BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL', 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM', 'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB'
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Gallbladder_trts (\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) \hich\af4\dbch\af31505\loch\f4 COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Gallbladder_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a\hich\af4\dbch\af31505\loch\f4 .bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAPECITABINE', 'FLUOROURACIL', 'GEMCITABINE HCL', 'OXALIPLATIN')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_\hich\af4\dbch\af31505\loch\f4 Gallbladder_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Gallbladder = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner joi\hich\af4\dbch\af31505\loch\f4 n FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Gallbladder = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN\hich\af4\dbch\af31505\loch\f4 _Gallbladder_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Gallbladder = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner \hich\af4\dbch\af31505\loch\f4 join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Gallbladder = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.\hich\af4\dbch\af31505\loch\f4 bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Gallbladder = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Gallbladder = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs fo\hich\af4\dbch\af31505\loch\f4 r benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Gallbladder = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Gallbladder = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_I\hich\af4\dbch\af31505\loch\f4 D, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Gallbladder = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Gallbladder_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallb\hich\af4\dbch\af31505\loch\f4 ladder_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, c\hich\af4\dbch\af31505\loch\f4 lm_dt, Drug_category from IN_Gallbladder_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Gallbladder_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Gallbladder_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     sel\hich\af4\dbch\af31505\loch\f4 ect distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cisplatin', 'CISPLATIN') then 1 else 0 end) as Cisplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Gemcitabine', 'GEMCITABINE') then 1 else 0 end) as Gemcitabine_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Nabpaclitaxel', 'NABPACLITAXEL') then 1 else 0 end)\hich\af4\dbch\af31505\loch\f4  as Nabpaclitaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Capecitabine_fr >= 1 then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cisplatin_fr >= 1 then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(\hich\af4\dbch\af31505\loch\f4 case when Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Gemcitabine_fr >= 1 then 1 else 0 end) as Gemcitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Nabpaclitaxel_fr >= 1 then 1 else 0 end) as Nabpaclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Oxaliplatin_fr >= 1 then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Gallbladder_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \hich\af4\dbch\af31505\loch\f4     Capecitabine_fl, Cisplatin_fl, Fluorouracil_fl, Gemcitabine_fl, Nabpaclitaxel_fl, Oxaliplatin_fl,
\par \hich\af4\dbch\af31505\loch\f4    \hich\af4\dbch\af31505\loch\f4  Capecitabine_fr, Cisplatin_fr, Fluorouracil_fr, Gemcitabine_fr, Nabpaclitaxel_fr, Oxaliplatin_fr
\par \hich\af4\dbch\af31505\loch\f4     from IN_Gallbladder_elig as a left join IN_Gallbladder_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_Gallbladder_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct Capecitabine_fl, Cisplatin_fl, Fluorouracil_fl, Gemcitabine_fl, Nabpaclitaxel_fl, Oxaliplatin_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Gallbladder_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by     Capecitabine_fl, Cisplatin_f\hich\af4\dbch\af31505\loch\f4 l, Fluorouracil_fl, Gemcitabine_fl, Nabpaclitaxel_fl, Oxaliplatin_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_Gallbladder_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Gallbladder_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---  benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_Lung10_trtinit;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Gallbladder_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Capecitabine', 'CAPECITABINE') then 1 else 0 end) as Capecitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cisplatin', 'CISPLATIN') then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_\hich\af4\dbch\af31505\loch\f4 category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Gemcitabine', 'GEMCITABINE') then 1 else 0 end) as Gemcitabine_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Nabpaclitaxel', 'NABPACLITAXEL') then 1 else 0 end) as Nabpaclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Oxaliplatin', 'OXALIPLATIN') then 1 else 0 end) as Oxaliplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Gallbladder_4trt a left join IN_Gallbladder_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 gr\hich\af4\dbch\af31505\loch\f4 oup by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Gallbladder_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt,
\par \hich\af4\dbch\af31505\loch\f4      Capecitabine_fl, Cisplatin_fl, Fluorouracil_fl, Gemcitabine_fl, Nabpaclitaxel_fl, Oxaliplatin_fl,
\par \hich\af4\dbch\af31505\loch\f4     (Capecitabine_fl+ Cisplatin_fl + Fluorouracil_fl + Gemcitabine_fl + Nabpaclitaxel_fl + Oxaliplatin_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_Gallbladder_elig a left join IN_Gallbladder_60d b on a.bene_id = b.bene_id)
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct Capecit\hich\af4\dbch\af31505\loch\f4 abine_fl, Cisplatin_fl, Fluorouracil_fl, Gemcitabine_fl, Nabpaclitaxel_fl, Oxaliplatin_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_all
\par \hich\af4\dbch\af31505\loch\f4 --group by     Capecitabine_fl, Cisplatin_fl, Fluorouracil_fl, Gemcitabine_fl, Nabpaclitaxel_fl, Oxaliplatin_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Gallbladder_trts\tab \tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4   (case 
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 1 and Fluorouracil_fl = 1 \tab \tab \tab then 24029
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Fluorouracil_fl = 1 and Cisplatin_fl = 1 \tab \tab \tab then 24030
\par \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Fluorouracil_fl = 1 and Oxaliplatin_fl = 1 \tab \tab \tab then 24031
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 1 and Capecitabine_fl = 1\tab \tab \tab then 24033
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Cisplatin_fl = 1 and\hich\af4\dbch\af31505\loch\f4  Capecitabine_fl = 1\tab \tab \tab then 24034
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Oxaliplatin_fl = 1 and\tab Capecitabine_fl = 1\tab \tab then 24035
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 1 and Gemcitabine_fl = 1\tab \tab \tab then 24037
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Capecitabine_fl = 1 and Gemcitabine_fl = 1\tab \tab \tab then 24038
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Cisplatin_fl = 1 and Gemcitabine_fl = 1\tab \tab \tab then 24039
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Oxaliplatin_fl = 1 and\tab Gemcitabine_fl = 1\tab \tab then 24040
\par \hich\af4\dbch\af31505\loch\f4   when alldrugs = 3 and Cisplatin_fl = 1 and Gemcitabine_fl = 1 and Nabpaclitaxel_fl = 1\tab \tab then 24109
\par \hich\af4\dbch\af31505\loch\f4   when \hich\af4\dbch\af31505\loch\f4 alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4   else 999 --- incomp regimens
\par \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \hich\af4\dbch\af31505\loch\f4  
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_check
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Myeloma1 **************************************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 --'BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL', 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM', 'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB'
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Myeloma1_trts_f (\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt d\hich\af4\dbch\af31505\loch\f4 ate NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index mm1 on IN_Myeloma1_trts_f;
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_Myeloma1_elig as (select distinct bene_ID, Diag_Start_Date, end_fu from 
\par \hich\af4\dbch\af31505\loch\f4  \tab IN_mm_getelig_f where (age <= 75 and frail_score <0.2) or (transplant_st = 1)),
\par 
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) a\hich\af4\dbch\af31505\loch\f4 nd (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('BORTEZOMIB', 'CARFILZOMIB', 'CYCLOPHOSPHAMIDE', 'DARATUMUMAB', 'DARATUMUMAB-HYALURONIDASE-FIHJ',
\par \hich\af4\dbch\af31505\loch\f4                      'DEXAMETHASONE', 'DEXAMETHASONE SOD PHOSPHATE',    'DEXAMETHASONE SODIUM PHOSPHATE', 'DOXORUBICIN HCL', 
\par \hich\af4\dbch\af31505\loch\f4                      'DOXORUBICIN HCL PEG-LIPOSOMAL', 'IXAZOMIB CITRATE','LENALIDOMIDE', 'THALIDOMIDE')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Myeloma1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_St\hich\af4\dbch\af31505\loch\f4 art_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Myeloma1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug\hich\af4\dbch\af31505\loch\f4 _category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Myeloma1 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 6\hich\af4\dbch\af31505\loch\f4 0, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Myeloma1 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_\hich\af4\dbch\af31505\loch\f4 Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Myeloma1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, en\hich\af4\dbch\af31505\loch\f4 d_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Myeloma1 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_c\hich\af4\dbch\af31505\loch\f4 ategory
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Myeloma1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join MC_FFS_SNF_PROC\hich\af4\dbch\af31505\loch\f4  as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Myeloma1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Myeloma1 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Myeloma1_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          s\hich\af4\dbch\af31505\loch\f4 elect distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1\hich\af4\dbch\af31505\loch\f4 _HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma1_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_c\hich\af4\dbch\af31505\loch\f4 ategory from IN_Myeloma1_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Myeloma1_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_categor\hich\af4\dbch\af31505\loch\f4 y in ('Bortezomib', 'BORTEZOMIB') then 1 else 0 end) as Bortezomib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Carfilzomib', 'CARFILZOMIB') then 1 else 0 end) as Carfilzomib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cisplatin', 'CISPLATIN') then 1 else 0 end) as Cisplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cyclophosphamide', 'CYCLOPHOSPHAMIDE') then 1 else 0 end) as Cyclophosphamide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Daratumumab', 'DARATUMUMAB','DARATUMUMAB-HYALURONIDASE-FIHJ') then 1 else 0 end) as Daratumumab\hich\af4\dbch\af31505\loch\f4 _fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Dexamethasone', 'DEXAMETHASONE','DEXAMETHASONE SOD PHOSPHATE',    'DEXAMETHASONE SODIUM PHOSPHATE') then 1 else 0 end) as Dexamethasone_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Doxorubicin', 'DOXORUBICIN','DOXORUBICIN HCL') then 1 else 0 end) as Doxorubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Etoposide', 'ETOPOSIDE') then 1 else 0 end) as Etoposide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ixazomib', 'IXAZOMIB','IXAZOMIB CITRATE') then 1 else 0 end) as Ixazomib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(cas\hich\af4\dbch\af31505\loch\f4 e when Drug_category in ('Lenalidomide', 'LENALIDOMIDE') then 1 else 0 end) as Lenalidomide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Liposomal doxorubicin', 'LIPOSOMAL DOXORUBICIN','DOXORUBICIN HCL PEG-LIPOSOMAL') then 1 else 0 end) as Lipo_doxorubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Thalidomide', 'THALIDOMIDE') then 1 else 0 end) as Thalidomide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Vincristine', 'VINCRISTINE') then 1 else 0 end) as Vincristine_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by be\hich\af4\dbch\af31505\loch\f4 ne_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Bortezomib_fr >= 1 then 1 else 0 end) as Bortezomib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Car\hich\af4\dbch\af31505\loch\f4 filzomib_fr >= 1 then 1 else 0 end) as Carfilzomib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cisplatin_fr >= 1 then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cyclophosphamide_fr >= 1 then 1 else 0 end) as Cyclophosphamide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Daratumumab_fr >= 1 then 1 else 0 end) as Daratumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Dexamethasone_fr >= 1 then 1 else 0 end) as Dexamethasone_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Doxorubicin_fr >= 1 then 1 else 0 end) as Doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Etoposide_fr >= 1 then 1 else 0 end) as Etoposide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ixazomib_fr >= 1 then 1 el\hich\af4\dbch\af31505\loch\f4 se 0 end) as Ixazomib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lenalidomide_fr >= 1 then 1 else 0 end) as Lenalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lipo_doxorubicin_fr >= 1 then 1 else 0 end) as Lipo_doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Thalidomide_fr >= 1 then 1 else 0 end) as Thalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Vincristine_fr >= 1 then 1 else 0 end) as Vincristine_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma1_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \tab \hich\af4\dbch\af31505\loch\f4 Bortezomib_fl, Carfilzomib_fl, Cisplatin_fl, Cyclophosphamide_fl, Daratumumab\hich\af4\dbch\af31505\loch\f4 _fl, Dexamethasone_fl, Doxorubicin_fl,
\par \hich\af4\dbch\af31505\loch\f4     Etoposide_fl, Ixazomib_fl, Lenalidomide_fl, Lipo_doxorubicin_fl, Thalidomide_fl, Vincristine_fl,
\par \hich\af4\dbch\af31505\loch\f4     Bortezomib_fr, Carfilzomib_fr, Cisplatin_fr, Cyclophosphamide_fr, Daratumumab_fr, Dexamethasone_fr, Doxorubicin_fr,
\par \hich\af4\dbch\af31505\loch\f4     Etoposide_fr, Ixazomib_fr, Lenalidomide_fr, Lipo_doxorubicin_fr, Thalidomide_fr, Vincristine_fr
\par \hich\af4\dbch\af31505\loch\f4     from IN_Myeloma1_elig as a left join IN_Myeloma1_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab left join IN_Myeloma1_drugfreq as c\hich\af4\dbch\af31505\loch\f4  on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab Bortezomib_fl, Carfilzomib_fl, Cisplatin_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Etoposide_fl, Ixazomib_fl, Lenalidomide_fl, Lipo_doxorubicin_fl, Thalidomide_fl, Vincristine_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Myeloma1_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by \tab Bortezomib_fl, Carfilzomib_fl, Cisplatin_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Etoposide_fl, Ixazomib_fl, Lenalidomide_fl, Lipo_doxorubicin_fl, Thalidomide_fl, Vincristine_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma1_trtinit as (se\hich\af4\dbch\af31505\loch\f4 lect distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Myeloma1_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4                             group by bene_ID, end_fu)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get first date a med was given. but dont include dexa
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma1_nondexa as (select distinct bene_id, min(clm_dt) as nondexa_1stdt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene_nondexa
\par \hich\af4\dbch\af31505\loch\f4  from IN_Myeloma1_4trt
\par \hich\af4\dbch\af31505\loch\f4  where clm_dt <= end_fu and Drug_category not in ('Dexamethasone', 'DEXA\hich\af4\dbch\af31505\loch\f4 METHASONE','DEXAMETHASONE SOD PHOSPHATE',    'DEXAMETHASONE SODIUM PHOSPHATE') 
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get first date a dexa was given
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma1_dexa as (select distinct bene_id, min(clm_dt) as dexa_1stdt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene_dexa
\par \hich\af4\dbch\af31505\loch\f4  from IN_Myeloma1_4trt
\par \hich\af4\dbch\af31505\loch\f4  where clm_dt <= end_fu and Drug_category in ('Dexamethasone', 'DEXAMETHASONE','DEXAMETHASONE SOD PHOSPHATE',    'DEXAMETHASONE SODIUM PHOSPHATE') 
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- 
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma1_check1sdrug as (select distinct a.bene_ID, a.trtinit_dt, b.nondexa_1stdt, c.dexa_1stdt, c.end_fu_bene_dexa from
\par \hich\af4\dbch\af31505\loch\f4                               IN_Myeloma1_trtinit a left join IN_Myeloma1_nondexa b on a.bene_ID = b.bene_id
\par \tab \tab \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4                         left join IN_Myeloma1_dexa c on a.BENE_ID = c.BENE_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- 1640 do not have dexa as 1s drug
\par \hich\af4\dbch\af31505\loch\f4 -- select count(distinct bene_ID) from IN_Myeloma1_check1sdrug where trtinit_dt = nondexa_1stdt;
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- 2833 have dexa as 1s drug
\par \hich\af4\dbch\af31505\loch\f4 -- select count(distinct be\hich\af4\dbch\af31505\loch\f4 ne_ID) from IN_Myeloma1_check1sdrug where trtinit_dt = dexa_1stdt;
\par 
\par ----
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma1_dexa1s as (select * from IN_Myeloma1_check1sdrug
\par \hich\af4\dbch\af31505\loch\f4 where (dexa_1stdt is not null) and dexa_1stdt = trtinit_dt)
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- select distinct bene_ID from IN_Myeloma1_dexa1s;
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to get flag if they have another med in the 60 days from when the 1st dexa is given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Myeloma1_60d_dexa as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select a.BENE_ID, a.Diag_Start_Date, b.dexa_1stdt, b.end_fu_bene_dexa
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category not in ('Dexamethasone', 'DEXAM\hich\af4\dbch\af31505\loch\f4 ETHASONE','DEXAMETHASONE SOD PHOSPHATE',    'DEXAMETHASONE SODIUM PHOSPHATE') then 1 else 0 end) as nondexadrug
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_4trt a inner join IN_Myeloma1_dexa1s b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene_dexa 
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.dexa_1stdt, b.end_fu_bene_dexa)
\par 
\par \hich\af4\dbch\af31505\loch\f4 -- 2633 benes have dexa 1s and also another drug in 60 days
\par \hich\af4\dbch\af31505\loch\f4 -- se\hich\af4\dbch\af31505\loch\f4 lect count(distinct bene_ID) from IN_Myeloma1_60d_dexa where nondexadrug = 1;
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct bene_ID from IN_Myeloma1_60d_dexa where nondexadrug = 1;
\par \hich\af4\dbch\af31505\loch\f4 -- select distinct bene_ID from IN_Myeloma1_60d_dexa where nondexadrug = 0;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- 200 have dexa as reg
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma1_dexareg as (select bene_id, dexa_1stdt as trtinit_dt, 27082 as trtreg 
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_60d_dexa where nondexadrug = 0)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- benes non dexa regs
\par \hich\af4\dbch\af31505\loch\f4 --, IN_Myeloma1_nondexacheck as (select a.* from 
\par \hich\af4\dbch\af31505\loch\f4 --IN_Myeloma1_trtinit a left join IN_Myel\hich\af4\dbch\af31505\loch\f4 oma1_dexareg b on a.bene_id = b.bene_id where b.bene_id is NULL)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims using nondexa when given 1s
\par \hich\af4\dbch\af31505\loch\f4 ----- will assign dexa  to the 200 patients after this step. do flags across all patients for the step below 
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Myeloma1_60d_nondexa as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select a.BENE_ID, a.Diag_Start_Date, b.trtinit_dt, b.end_fu_bene 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Bortezomib', 'BORTEZOMIB') then 1 else 0 end) as Bortezomib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('\hich\af4\dbch\af31505\loch\f4 Carfilzomib', 'CARFILZOMIB') then 1 else 0 end) as Carfilzomib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cisplatin', 'CISPLATIN') then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cyclophosphamide', 'CYCLOPHOSPHAMIDE') then 1 else 0 end) as Cyclophosphamide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Daratumumab', 'DARATUMUMAB','DARATUMUMAB-HYALURONIDASE-FIHJ') then 1 else 0 end) as Daratumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Dexamethasone', 'DEXAMETHASONE','DEXAMETHASONE SOD PHOSPHATE',    'DEXAMETHASONE SODIUM PHOSPHATE') then 1 else 0 end) as Dexamethasone_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Doxorubicin', 'DOXORUBICIN','DOXORUBICIN HCL') then 1 else 0 end) as Doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Etoposide', 'ETOPOSIDE') then 1 else 0 end) as Etoposide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ixazomib', 'IXAZOMIB','IXAZOMIB CITRATE') then 1 else 0 end) as Ixazomib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case wh\hich\af4\dbch\af31505\loch\f4 en Drug_category in ('Lenalidomide', 'LENALIDOMIDE') then 1 else 0 end) as Lenalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Liposomal doxorubicin', 'LIPOSOMAL DOXORUBICIN','DOXORUBICIN HCL PEG-LIPOSOMAL') then 1 else 0 end) as Lipo_doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Thalidomide', 'THALIDOMIDE') then 1 else 0 end) as Thalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Vincristine', 'VINCRISTINE') then 1 else 0 end) as Vincristine_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma1_4trt a left join IN_Myeloma1_trtinit b on a.\hich\af4\dbch\af31505\loch\f4 bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.trtinit_dt, b.end_fu_bene)
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Myeloma1_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select a.bene_ID, a.Diag_Start_Date, --coalesce(b.trtinit_dt, c.trtinit_dt) as 
\par \tab \hich\af4\dbch\af31505\loch\f4 b.trtinit_dt, 
\par \tab \hich\af4\dbch\af31505\loch\f4 Bortezomib_fl, Carfilzomib_fl, Cisplatin_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl,
\par \hich\af4\dbch\af31505\loch\f4     Etoposide_fl, Ixazomib_fl, Lenalidomide_fl, Lipo_doxorubicin_fl, Thalidomide_fl, Vincristine_fl, 
\par \hich\af4\dbch\af31505\loch\f4     (Bortezomib_fl+ Carfilzomi\hich\af4\dbch\af31505\loch\f4 b_fl+ Cisplatin_fl+ Cyclophosphamide_fl+ Daratumumab_fl+ --Dexamethasone_fl+  
\par \hich\af4\dbch\af31505\loch\f4     Doxorubicin_fl+ Etoposide_fl+ Ixazomib_fl+ Lenalidomide_fl+ Lipo_doxorubicin_fl+ Thalidomide_fl+ Vincristine_fl) as alldrugs
\par \hich\af4\dbch\af31505\loch\f4     --,c.trtreg as dexareg     from IN_Myeloma1_60d_nondexa
\par \hich\af4\dbch\af31505\loch\f4  from IN_Myeloma1_elig a left join IN_Myeloma1_60d_nondexa b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4   --                  left join IN_Myeloma1_dexareg c on a.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4 )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct \tab Bortezomib_fl, Carfilzomib_fl, Cisplatin_fl, Cyclophospha\hich\af4\dbch\af31505\loch\f4 mide_fl, Daratumumab_fl, Dexamethasone_fl, 
\par \hich\af4\dbch\af31505\loch\f4 -- Doxorubicin_fl,  Etoposide_fl, Ixazomib_fl, Lenalidomide_fl, Lipo_doxorubicin_fl, Thalidomide_fl, Vincristine_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_all
\par \hich\af4\dbch\af31505\loch\f4 --group by \tab Bortezomib_fl, Carfilzomib_fl, Cisplatin_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, 
\par \hich\af4\dbch\af31505\loch\f4 --Doxorubicin_fl, Etoposide_fl, Ixazomib_fl, Lenalidomide_fl, Lipo_doxorubicin_fl, Thalidomide_fl, Vincristine_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Myeloma1_trts_f\tab \tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4   (case 
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Bortezomib_fl = 1\tab \hich\af4\dbch\af31505\loch\f4                         then 27006
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1\tab and Cyclophosphamide_fl = 1 then 27002
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1\tab and Doxorubicin_fl = 1\tab then 27003
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1\tab and Lenalidomide_fl = 1 then 27001
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1\tab and Thalidomide_fl = 1\tab then 27007
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Lenalidomide_fl = 1\tab                     then 27009
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 0 and Dexamethasone_fl = 1\tab \tab \tab              then 27082
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Lipo\hich\af4\dbch\af31505\loch\f4 _doxorubicin_fl = 1 and Vincristine_fl = 1 then 27083
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Thalidomide_fl = 1                           then 27084
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Lenalidomide_fl = 1\tab and Carfilzomib_fl = 1 then 27004
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Lenalidomide_fl = 1\tab and Ixazomib_fl = 1\tab    then 27005
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Cyclophosphamide_fl = 1\tab and Carfilzomib_fl = 1 then 27056
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Cyclophosphamide_fl = 1\tab and Ixazomib_fl = 1\tab then 27057
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Cyclophosphamide_fl = 1 and Lenalidomide_fl\hich\af4\dbch\af31505\loch\f4  = 1 then 27008
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Bortezomib_fl = 1 and Thalidomide_fl = 1\tab and Daratumumab_fl = 1\tab then 27058
\par \tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 6 and Bortezomib_fl = 1 and Cyclophosphamide_fl = 1 and Doxorubicin_fl = 1 
\par \tab \hich\af4\dbch\af31505\loch\f4      and Thalidomide_fl = 1\tab and Cisplatin_fl = 1 and Etoposide_fl = 1 then 27010
\par --\tab \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3 and Dexamethasone_fl = 1 and Lenalidomide_fl = 1\tab and Daratumumab_fl = 1\tab and (nondexa_1stdt = trtinit_dt) then 17
\par \hich\af4\dbch\af31505\loch\f4         when alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4     else 999 --- incomp regimens
\par \tab \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \tab 
\par 
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_Myeloma1_trts_f
\par \tab \hich\af4\dbch\af31505\loch\f4 group by trtreg;
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** Myeloma2 **************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************************************************************\hich\af4\dbch\af31505\loch\f4 */
\par 
\par \hich\af4\dbch\af31505\loch\f4 --'BEVACIZUMAB', 'CAPECITABINE', 'CETUXIMAB', 'FLUOROURACIL', 'IRINOTECAN HCL', 'LEUCOVORIN CALCIUM', 'NIVOLUMAB', 'OXALIPLATIN', 'PANITUMUMAB'
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_Myeloma2_trts_f (\tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index mm1 on IN_Myeloma2_trts_f;
\par 
\par \hich\af4\dbch\af31505\loch\f4 with IN_Myeloma2_elig as (select distinct bene_ID, Diag_Start_Date, end_fu from 
\par \hich\af4\dbch\af31505\loch\f4  \tab \hich\af4\dbch\af31505\loch\f4 IN_mm_getelig_f where (age  > 75 or frail_score >=0.2) and (transplant_st is NULL)),
\par 
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category 
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('BORTEZOMIB', 'CARFILZOMIB', 'CYCLOPHOSPHAMIDE', 'DARATUMUMAB', 'DARATUMUMAB-HYALURONIDASE-FIHJ',
\par \hich\af4\dbch\af31505\loch\f4                      'DEXA\hich\af4\dbch\af31505\loch\f4 METHASONE', 'DEXAMETHASONE SOD PHOSPHATE',  'DEXAMETHASONE SOD PHOSPHATE/PF',  
\par \hich\af4\dbch\af31505\loch\f4                      'DEXAMETHASONE SODIUM PHOSPHATE', 'DOXORUBICIN HCL', 'IXAZOMIB CITRATE', 'LENALIDOMIDE',
\par \hich\af4\dbch\af31505\loch\f4                      'DOXORUBICIN HCL PEG-LIPOSOMAL', 'MELPHALAN', 'PREDNISOLONE', 'PREDNISOLONE ACETATE', 
\par \hich\af4\dbch\af31505\loch\f4                      'PREDNISOLONE SOD PHOSPHATE', 'PREDNISOLONE SODIUM PHOSPHATE', 'PREDNISONE', 'THALIDOMIDE'
\par \hich\af4\dbch\af31505\loch\f4 )),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_I\hich\af4\dbch\af31505\loch\f4 D, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Myeloma2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select di\hich\af4\dbch\af31505\loch\f4 stinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Myeloma2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_E\hich\af4\dbch\af31505\loch\f4 XPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Myeloma2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 fr\hich\af4\dbch\af31505\loch\f4 om IN_Myeloma2_elig as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.Myeloma2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Myeloma2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join FFS\hich\af4\dbch\af31505\loch\f4 _DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.Myeloma2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_\hich\af4\dbch\af31505\loch\f4 elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Myeloma2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.ben\hich\af4\dbch\af31505\loch\f4 e_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Myeloma2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as \hich\af4\dbch\af31505\loch\f4 c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.Myeloma2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_Myeloma2_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from I\hich\af4\dbch\af31505\loch\f4 N_Myeloma2_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_Myeloma2_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_\hich\af4\dbch\af31505\loch\f4 dt, Drug_category from IN_Myeloma2_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_Myeloma2_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Bortezomib', 'BORTEZOMIB') then 1 else 0 end) as Bortezomib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Carfilzomib', 'CARFILZOMIB') then 1 else 0 end) as Carfilzomib_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cyclophosphamide', 'CYCLOPHOSPHAMIDE') then 1 else 0 end) as Cyclophosphamide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Daratumumab', 'DARATUMUM\hich\af4\dbch\af31505\loch\f4 AB','DARATUMUMAB-HYALURONIDASE-FIHJ') then 1 else 0 end) as Daratumumab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Dexamethasone', 'DEXAMETHASONE','DEXAMETHASONE SOD PHOSPHATE', 'DEXAMETHASONE SOD PHOSPHATE/PF', 'DEXAMETHASONE SODIUM PHOSPHATE') then 1 else 0 end) as Dexamethasone_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Doxorubicin', 'DOXORUBICIN','DOXORUBICIN HCL') then 1 else 0 end) as Doxorubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Ixazomib', 'IXAZOMIB','IXAZOMIB CITRATE') then 1 else 0 end) as Ixazomib_fr
\par \hich\af4\dbch\af31505\loch\f4 , \hich\af4\dbch\af31505\loch\f4 sum(case when Drug_category in ('Lenalidomide', 'LENALIDOMIDE') then 1 else 0 end) as Lenalidomide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Liposomal doxorubicin', 'LIPOSOMAL DOXORUBICIN','DOXORUBICIN HCL PEG-LIPOSOMAL') then 1 else 0 end) as Lipo_doxorubicin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Melphalan', 'MELPHALAN') then 1 else 0 end) as Melphalan_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case\hich\af4\dbch\af31505\loch\f4 
 when Drug_category in ('Prednisone', 'PREDNISONE','PREDNISOLONE', 'PREDNISOLONE ACETATE', 'PREDNISOLONE SOD PHOSPHATE', 'PREDNISOLONE SODIUM PHOSPHATE') then 1 else 0 end) as Prednisone_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Thalidomide', 'THALIDOMIDE') then 1 else 0 end) as Thalidomide_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Vincristine', 'VINCRISTINE') then 1 else 0 end) as Vincristine_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_drug\hich\af4\dbch\af31505\loch\f4 flag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Bortezomib_fr >= 1 then 1 else 0 end) as Bortezomib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Carfilzomib_fr >= 1 then 1 else 0 end) as Carfilzomib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cyclophosphamide_fr >= 1 then 1 else 0 end) as Cyclophosphamide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Daratumumab_fr >= 1 then 1 else 0 end) as Daratumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Dexamethasone_fr >= 1 then 1 else 0 end) as Dexamethasone_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Doxorubicin_fr >= 1 then 1 else 0 end) as Doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Ixazomib_fr >= 1 then 1 else 0 end\hich\af4\dbch\af31505\loch\f4 ) as Ixazomib_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lenalidomide_fr >= 1 then 1 else 0 end) as Lenalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Lipo_doxorubicin_fr >= 1 then 1 else 0 end) as Lipo_doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Melphalan_fr >= 1 then 1 else 0 end) as Melphalan_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Prednisone_fr >= 1 then 1 else 0 end) as Prednisone_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Thalidomide_fr >= 1 then 1 else 0 end) as Thalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Vincristine_fr >= 1 then 1 else 0 end) as Vincristine_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_Myeloma2_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, 
\par \tab \hich\af4\dbch\af31505\loch\f4 Bortezomib_fl, Carfilzomib_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl, Ixazomib_fl,
\par \hich\af4\dbch\af31505\loch\f4     Lenalidomide_fl, Lipo_doxorubicin_fl, Melphalan_fl, Prednisone_fl, Thalidomide_fl, Vincristine_fl,
\par \hich\af4\dbch\af31505\loch\f4     Bortezomib_fr, Carfilzomib_fr, Cyclophosphamide_fr, Daratumumab_fr, Dexamethasone_fr, Doxorubicin_fr, Ixazomib_fr,
\par \hich\af4\dbch\af31505\loch\f4     Lenalidomide_fr, Lipo_doxorubicin_fr, Melphalan_fr, Prednisone_fr, Thalidomide_fr, Vincri\hich\af4\dbch\af31505\loch\f4 stine_fr
\par \hich\af4\dbch\af31505\loch\f4     from IN_Myeloma2_elig as a left join IN_Myeloma2_drugflag as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab    left join IN_Myeloma2_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct Bortezomib_fl, Carfilzomib_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl, Ixazomib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Lenalidomide_fl, Lipo_doxorubicin_fl, Melphalan_fl, Prednisone_fl, Thalidomide_fl, Vincristine_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_Myeloma2_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by Bortezom\hich\af4\dbch\af31505\loch\f4 ib_fl, Carfilzomib_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl, Ixazomib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Lenalidomide_fl, Lipo_doxorubicin_fl, Melphalan_fl, Prednisone_fl, Thalidomide_fl, Vincristine_fl;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days after this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma2_trtinit as (select distinct bene_id, min(clm_dt) as trtinit_dt, DATEADD(DAY, 60, min(clm_dt)) as end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4                             from IN_Myeloma2_4trt where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4               \hich\af4\dbch\af31505\loch\f4               group by bene_ID, end_fu)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---  benes have some med
\par \hich\af4\dbch\af31505\loch\f4 --- select count(*), count (distinct bene_ID) as benes from IN_Lung10_trtinit;
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get first date a med was given. but dont include dexa
\par \hich\af4\dbch\af31505\loch\f4 , IN_Myeloma2_nondexa as (select distinct bene_id, min(clm_dt) as nondexa_1stdt from IN_Myeloma2_4trt
\par \hich\af4\dbch\af31505\loch\f4  where clm_dt <= end_fu and Drug_category not in ('Dexamethasone', 'DEXAMETHASONE','DEXAMETHASONE SOD PHOSPHATE', 'DEXAMETHASONE SOD PHOSPHATE/PF', 'DEXAMETHASONE SODIUM PHOSPHATE') 
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID)
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_Myeloma2_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct \hich\af4\dbch\af31505\loch\f4 a.BENE_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Bortezomib', 'BORTEZOMIB') then 1 else 0 end) as Bortezomib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Carfilzomib', 'CARFILZOMIB') then 1 else 0 end) as Carfilzomib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cyclophosphamide', 'CYCLOPHOSPHAMIDE') then 1 else 0 end) as Cyclophosphamide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Daratumumab', 'DARATUMUMAB','DARATUMUMAB-HYALURONIDASE-FIHJ') then 1 else 0 end) as Daratumumab_fl
\par \hich\af4\dbch\af31505\loch\f4 , ma\hich\af4\dbch\af31505\loch\f4 
x(case when Drug_category in ('Dexamethasone', 'DEXAMETHASONE','DEXAMETHASONE SOD PHOSPHATE', 'DEXAMETHASONE SOD PHOSPHATE/PF', 'DEXAMETHASONE SODIUM PHOSPHATE') then 1 else 0 end) as Dexamethasone_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Doxorubicin', 'DOXORUBICIN','DOXORUBICIN HCL') then 1 else 0 end) as Doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Ixazomib', 'IXAZOMIB','IXAZOMIB CITRATE') then 1 else 0 end) as Ixazomib_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Lenalidomide', 'LENALIDOMIDE') then 1 else 0 e\hich\af4\dbch\af31505\loch\f4 nd) as Lenalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Liposomal doxorubicin', 'LIPOSOMAL DOXORUBICIN','DOXORUBICIN HCL PEG-LIPOSOMAL') then 1 else 0 end) as Lipo_doxorubicin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Melphalan', 'MELPHALAN') then 1 else 0 end) as Melphalan_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Prednisone', 'PREDNISONE','PREDNISOLONE', 'PREDNISOLONE ACETATE', 'PREDNISOLONE SOD PHOSPHATE', 'PREDNISOLONE SODIUM PHOSPHATE') then 1 else 0 end) as Prednisone_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('T\hich\af4\dbch\af31505\loch\f4 halidomide', 'THALIDOMIDE') then 1 else 0 end) as Thalidomide_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Vincristine', 'VINCRISTINE') then 1 else 0 end) as Vincristine_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_Myeloma2_4trt a left join IN_Myeloma2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_Myeloma2_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt,
\par \hich\af4\dbch\af31505\loch\f4 Bortezomib_fl, Carfilzomib_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl, Ixazomib_fl,
\par \hich\af4\dbch\af31505\loch\f4     Lenalidomide_fl, Lipo_doxorubicin_fl, Melphalan_fl, Prednisone_fl, Thalidomide_fl, Vincristine_fl,
\par \hich\af4\dbch\af31505\loch\f4      --   c.nondexa_1stdt, d.trtinit_dt,
\par \hich\af4\dbch\af31505\loch\f4     (Bortezomib_fl+ Carfilzomib_fl+ Cyclophosphamide_fl+ Daratumumab_fl--+ Dexamethasone_fl
\par \hich\af4\dbch\af31505\loch\f4     \tab + Doxorubicin_fl+ Ixazomib_fl+  Lenalidomide_fl+ Lipo_doxorubicin_fl+ Melphalan_fl+\hich\af4\dbch\af31505\loch\f4  --Prednisone_fl+ 
\par \hich\af4\dbch\af31505\loch\f4     Thalidomide_fl+ Vincristine_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_Myeloma2_elig a left join IN_Myeloma2_60d b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                 --    left join IN_Myeloma2_nondexa c on a.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4                 --   left join IN_Myeloma2_trtinit d on a.bene_id = d.bene_id 
\par \hich\af4\dbch\af31505\loch\f4      )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct Bortezomib_fl, Carfilzomib_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl, Ixazomib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Lenalidomide_fl, Lipo_doxorubicin_fl, Melphalan_fl, Thalidomi\hich\af4\dbch\af31505\loch\f4 de_fl, Vincristine_fl, count (distinct bene_ID) as benes
\par \hich\af4\dbch\af31505\loch\f4 --from IN_all
\par \hich\af4\dbch\af31505\loch\f4 --group by Bortezomib_fl, Carfilzomib_fl, Cyclophosphamide_fl, Daratumumab_fl, Dexamethasone_fl, Doxorubicin_fl, Ixazomib_fl,
\par \hich\af4\dbch\af31505\loch\f4 --    Lenalidomide_fl, Lipo_doxorubicin_fl, Melphalan_fl, Thalidomide_fl, Vincristine_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_Myeloma2_trts_f\tab \tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,\tab \tab 
\par \tab \hich\af4\dbch\af31505\loch\f4   (case 
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1 and Bortezomib_fl = 1\tab                         \tab \tab then 27018
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1\tab and Cyclophosphamide_fl = 1\tab \tab then 27013
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1\tab and Lenalidomide_fl = 1\tab \tab \tab then 27011
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1                       and Lenalidomide_fl = 1\tab \tab \tab then 27012
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2 and Bortezomib_fl = 1 and Melphalan_fl = 1\tab \tab     then 27085
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Lenalidomide_fl = 1 and Melphalan_fl = 1 then 27086\tab \tab \tab  
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Melphalan_fl = 1 and Thalidomide_fl = 1  then 27087\tab \tab \tab  
\par \hich\af4\dbch\af31505\loch\f4 w\hich\af4\dbch\af31505\loch\f4 hen alldrugs = 0                       and Dexamethasone_fl = 1  \tab \tab \tab          then 27088
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Lipo_doxorubicin_fl = 1 and Vincristine_fl = 1\tab then 27089
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1                       and Dexamethasone_fl = 0 and Melphalan_fl = 1\tab \tab \tab then 27090
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 1                       and Thalidomide_fl = 1\tab \tab \tab then 27091
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Doxorubicin_fl = 1 and Vincristine_fl = 1\tab then 27092
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Lenali\hich\af4\dbch\af31505\loch\f4 domide_fl = 1 and Ixazomib_fl = 1\tab \tab \tab then 27017
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Lenalidomide_fl = 1 and Carfilzomib_fl = 1\tab \tab \tab then 27015
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Cyclophosphamide_fl = 1 and Carfilzomib_fl = 1\tab then 27016
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 3                       and Bortezomib_fl = 1\tab and Melphalan_fl = 1 and Daratumumab_fl = 1\tab then 27014
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and Cyclophosphamide_fl = 1 and Lenalidomide_fl = 1\tab then 27019
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs = 2                       and\hich\af4\dbch\af31505\loch\f4  Lenalidomide_fl = 1 and Daratumumab_fl = 1\tab \tab \tab then 27063
\par \hich\af4\dbch\af31505\loch\f4 when alldrugs is NULL or alldrugs = 0                       then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4 else 999 --- incomp regimens
\par \tab \hich\af4\dbch\af31505\loch\f4       end) as trtreg
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_all;
\par \tab 
\par \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_Myeloma2_trts_f
\par \hich\af4\dbch\af31505\loch\f4 group by trtreg order by trtreg; 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /******************************** oral cavity and pharynx2 **********************/
\par \hich\af4\dbch\af31505\loch\f4 /*******************************************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 --drop table IN_ocavp2_trts
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_ocavp2_regtrts_f (\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index ocav on IN_ocavp2_regtrts_f;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_ocavp2_elig as (select distinct bene_ID, Diag_Start_Date, end_fu, subgrp from 
\par \hich\af4\dbch\af31505\loch\f4  \tab  IN_ocavp2\hich\af4\dbch\af31505\loch\f4 _chck_f),
\par 
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category 
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 wher\hich\af4\dbch\af31505\loch\f4 e ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CARBOPLATIN', 'CETUXIMAB', 'CISPLATIN', 'DOCETAXEL', 'FLUOROURACIL', 'HYDROXYUREA', 'PACLITAXEL')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD\hich\af4\dbch\af31505\loch\f4  = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.ocavp2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEAD\hich\af4\dbch\af31505\loch\f4 D(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.ocavp2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEAD\hich\af4\dbch\af31505\loch\f4 D(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.ocavp2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Sta\hich\af4\dbch\af31505\loch\f4 rt_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.ocavp2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.ocavp2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.ocavp2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during \hich\af4\dbch\af31505\loch\f4 fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.ocavp2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date\hich\af4\dbch\af31505\loch\f4 , end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.ocavp2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_elig as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.ocavp2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_ocavp2_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from\hich\af4\dbch\af31505\loch\f4  IN_ocavp2_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_cate\hich\af4\dbch\af31505\loch\f4 gory from IN_ocavp2_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   ) ,
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- frequencies for each drug
\par \hich\af4\dbch\af31505\loch\f4 IN_ocavp2_drugfreq as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Hydroxyurea', 'HYDROXYUREA') then 1 else 0 end) as Hydroxyurea_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Carboplatin', 'CARBOPLATIN') then 1 else 0 end) as Carboplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Paclitaxel', 'PACLITAXEL') then 1 else 0 end) as Paclitaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_\hich\af4\dbch\af31505\loch\f4 category in ('Cetuximab', 'CETUXIMAB') then 1 else 0 end) as Cetuximab_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Cisplatin', 'CISPLATIN') then 1 else 0 end) as Cisplatin_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Docetaxel', 'DOCETAXEL') then 1 else 0 end) as Docetaxel_fr
\par \hich\af4\dbch\af31505\loch\f4 , sum(case when Drug_category in ('Radiation') then 1 else 0 end) as Radiation_fr
\par \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_4trt 
\par \hich\af4\dbch\af31505\loch\f4 where clm_dt <= end_fu
\par \hich\af4\dbch\af31505\loch\f4 group by bene_ID),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ------- indicators for each drug 
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_drugflag as ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID 
\par \hich\af4\dbch\af31505\loch\f4 ,(case wh\hich\af4\dbch\af31505\loch\f4 en Fluorouracil_fr >= 1 then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Hydroxyurea_fr >= 1 then 1 else 0 end) as Hydroxyurea_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Carboplatin_fr >= 1 then 1 else 0 end) as Carboplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Paclitaxel_fr >= 1 then 1 else 0 end) as Paclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cetuximab_fr >= 1 then 1 else 0 end) as Cetuximab_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Cisplatin_fr >= 1 then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Docetaxel_fr >= 1 then 1 else 0 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 ,(case when Radiation_fr >= 1 then 1 else 0 end) as Radiation_fl
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_drugfreq ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- 
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_drugs as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, subgrp,
\par \hich\af4\dbch\af31505\loch\f4          Fluorouracil_fl, Hydroxyurea_fl, Carboplatin_fl, Paclitaxel_fl, Cetuximab_fl, Cisplatin_fl, Docetaxel_fl, Radiation_fl,
\par \hich\af4\dbch\af31505\loch\f4          Fluorouracil_fr, Hydroxyurea_fr, Carboplatin_fr, Paclitaxel_fr, Cetuximab_fr, Cisplatin_fr, Docetaxel_fr, Radiation_fr
\par \hich\af4\dbch\af31505\loch\f4     from IN_ocavp2_elig as a left join IN_ocavp2_drugflag as b on\hich\af4\dbch\af31505\loch\f4  a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab    left join IN_ocavp2_drugfreq as c on b.bene_id = c.bene_id
\par \hich\af4\dbch\af31505\loch\f4  \tab )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select distinct Fluorouracil_fl, Hydroxyurea_fl, Carboplatin_fl, Paclitaxel_fl, Cetuximab_fl, Cisplatin_fl, Docetaxel_fl, Radiation_fl,
\par \hich\af4\dbch\af31505\loch\f4 --count (distinct bene_ID) as benes from IN_ocavp2_drugs 
\par \hich\af4\dbch\af31505\loch\f4 --group by Fluorouracil_fl, Hydroxyurea_fl, Carboplatin_fl, Paclitaxel_fl, Cetuximab_fl, Cisplatin_fl, Docetaxel_fl, Radiation_fl;
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---- get trt initiation date as of end_fu. and also get the 60days a\hich\af4\dbch\af31505\loch\f4 fter this init date
\par \hich\af4\dbch\af31505\loch\f4 , IN_ocavp2_trtinit as (select distinct a.bene_id, min(a.clm_dt) as trtinit_dt, b.subgrp,
\par \tab \hich\af4\dbch\af31505\loch\f4                     DATEADD(DAY, 60, min(a.clm_dt)) as end_fu_bene from IN_ocavp2_4trt a left join IN_ocavp2_chck b on a.BENE_ID = b.bene_ID 
\par \tab \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= a.end_fu
\par \hich\af4\dbch\af31505\loch\f4                         group by a.bene_ID, b.subgrp)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- we want to now create flags for each bene using the 60 days claims as relevant per first med given
\par \hich\af4\dbch\af31505\loch\f4 ,IN_ocavp2_60d as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct a.BENE_ID, a.Diag_Start_Date, b.subgrp, b.end_fu_bene, b.trtinit_dt 
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Fluorouracil', 'FLUOROURACIL') then 1 else 0 end) as Fluorouracil_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Hydroxyurea', 'HYDROXYUREA') then 1 else 0 end) as Hydroxyurea_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Carboplatin', 'CARBOPLATIN') then 1 else 0 end) as Carbo\hich\af4\dbch\af31505\loch\f4 platin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Paclitaxel', 'PACLITAXEL') then 1 else 0 end) as Paclitaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cetuximab', 'CETUXIMAB') then 1 else 0 end) as Cetuximab_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Cisplatin', 'CISPLATIN') then 1 else 0 end) as Cisplatin_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Docetaxel', 'DOCETAXEL') then 1 else 0 end) as Docetaxel_fl
\par \hich\af4\dbch\af31505\loch\f4 , max(case when Drug_category in ('Radiation') then 1 else 0 end) as Radiation_fl
\par \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_4trt a left join IN_oc\hich\af4\dbch\af31505\loch\f4 avp2_trtinit b on a.bene_id= b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 where a.clm_dt <= b.end_fu_bene
\par \hich\af4\dbch\af31505\loch\f4 group by a.bene_ID, a.Diag_Start_Date, b.end_fu_bene, b.trtinit_dt, b.subgrp )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- select * from IN_ocavp2_60d
\par \hich\af4\dbch\af31505\loch\f4 , IN_all as (select distinct a.bene_ID, a.Diag_Start_Date, b.trtinit_dt, b.subgrp,
\par \hich\af4\dbch\af31505\loch\f4 Fluorouracil_fl, Hydroxyurea_fl, Carboplatin_fl, Paclitaxel_fl, Cetuximab_fl, Cisplatin_fl, Docetaxel_fl, Radiation_fl,
\par \hich\af4\dbch\af31505\loch\f4     (Fluorouracil_fl + Hydroxyurea_fl + Carboplatin_fl + Paclitaxel_fl + Cetuximab_fl + Cisplatin_fl + Docetaxel_fl + Radiatio\hich\af4\dbch\af31505\loch\f4 n_fl) as alldrugs from
\par \hich\af4\dbch\af31505\loch\f4  IN_ocavp2_elig a left join IN_ocavp2_60d b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4 )
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_cis as (select * from IN_ocavp2_4trt where  (Drug_category in ('Cisplatin', 'CISPLATIN')))
\par 
\par \hich\af4\dbch\af31505\loch\f4 ----- cisplatin claims for benes where cisplatin and radiation regimen applies. want claims for the 60 days period we are interested in
\par \hich\af4\dbch\af31505\loch\f4 -- a max of 12 cis claims appear in the 60 days that we are looking
\par \hich\af4\dbch\af31505\loch\f4 , IN_ocavp2_cisplat as (select a.*, b.clm_dt from
\par \tab \hich\af4\dbch\af31505\loch\f4 IN_all a left join IN_cis b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 --where  (Drug_category in ('Cisplatin', 'CISPLATIN')) and (alldrugs = 2 and Cisplatin_fl = 1 and Radiation_fl = 1)
\par \tab \hich\af4\dbch\af31505\loch\f4   --     and (clm_dt >= a.Diag_Start_Date and clm_dt <= dateadd(DAY, 60, trtinit_dt)) 
\par \hich\af4\dbch\af31505\loch\f4 )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select count(distinct bene_ID) from IN_ocavp2_cisplat;
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_cisdays as (
\par \hich\af4\dbch\af31505\loch\f4            select *,
\par \hich\af4\dbch\af31505\loch\f4            row_number() over(partition by bene_id order by clm_dt) as RowNum
\par \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_cisplat)
\par 
\par ---
\par \hich\af4\dbch\af31505\loch\f4 , IN_cisdays_piv as (SELECT distinct bene_ID, Diag_Start_Date, trtinit_dt, subgrp,
\par \hich\af4\dbch\af31505\loch\f4 Fluorouracil_fl, Hydroxyurea_fl, Carboplatin_fl, Paclitaxel_fl, Cetuximab_fl, Cisplatin_fl, Docetaxel_fl, Radiation_fl, alldrugs,      
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=1 then clm_dt end) \hich\af4\dbch\af31505\loch\f4 as cis1, 
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=2 then clm_dt end) as cis2, 
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=3 then clm_dt end) as cis3,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=4 then clm_dt end) as cis4,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=5 then clm_dt end) as cis5,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=6 then clm_dt end) as cis6,
\par \hich\af4\dbch\af31505\loch\f4                                               max(Case when rownum=7 then clm_dt end) as cis7
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_cisdays group by bene_ID, Diag_Start_Date, trtinit_dt, subgrp,
\par \hich\af4\dbch\af31505\loch\f4 Fluorouracil_fl, Hydroxyurea_fl, Carboplatin_fl, Paclitaxel_fl, Cetuximab_fl, Cisplatin_fl, Docetaxel_fl, Radiation_fl, alldrugs)
\par \hich\af4\dbch\af31505\loch\f4   
\par \hich\af4\dbch\af31505\loch\f4 , IN_ocavp2_cisplat_f as (select *, 
\par \tab \hich\af4\dbch\af31505\loch\f4 (case when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis7 is not null then 23010
\par \tab \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis4 is n\hich\af4\dbch\af31505\loch\f4 
ull and cis3 is not null and (DATEDIFF(day, cis2, cis3) > 14 and DATEDIFF(day, cis1, cis2) > 14) then 23009 --3 clms
\par \tab \tab \hich\af4\dbch\af31505\loch\f4   when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis3 is null and cis2 is not null and (DATEDIFF(day, cis1, cis2) > 14) then 23009 --2 clms
\par \hich\af4\dbch\af31505\loch\f4           --when cis2 is null then 777 -- one cis claim
\par 
\par \hich\af4\dbch\af31505\loch\f4           when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis7 is null and cis6 is not null and 
\par \hich\af4\dbch\af31505\loch\f4           (DATEDIFF(day, cis1, cis3) <= 20 or DATEDIFF(day, cis2, \hich\af4\dbch\af31505\loch\f4 cis4) <= 20 or DATEDIFF(day, cis3, cis5) <= 20 or DATEDIFF(day, cis4, cis6) <= 20)  then 23010
\par 
\par \hich\af4\dbch\af31505\loch\f4           when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis6 is null and cis5 is not null and 
\par \hich\af4\dbch\af31505\loch\f4           (DATEDIFF(day, cis1, cis3) <= 20 or DATEDIFF(day, cis2, cis4) <= 20 or DATEDIFF(day, cis3, cis5) <= 20)  then 23010
\par 
\par \hich\af4\dbch\af31505\loch\f4           when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis5 is null and cis4 is not null and 
\par \hich\af4\dbch\af31505\loch\f4           (DATEDIFF(day, cis1, cis3) <= 20 or DATEDIFF(day, cis\hich\af4\dbch\af31505\loch\f4 2, cis4) <= 20)  then 23010
\par 
\par \hich\af4\dbch\af31505\loch\f4           
\par \hich\af4\dbch\af31505\loch\f4           when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis7 is null and cis6 is not null and 
\par \hich\af4\dbch\af31505\loch\f4           (DATEDIFF(day, cis1, cis3) > 20 and DATEDIFF(day, cis2, cis4) > 20 and DATEDIFF(day, cis3, cis5) > 20 and DATEDIFF(day, cis4, cis6) > 20)  then 23009
\par 
\par \hich\af4\dbch\af31505\loch\f4           when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis6 is null and cis5 is not null and 
\par \hich\af4\dbch\af31505\loch\f4           (DATEDIFF(day, cis1, cis3) > 20 and DATEDIFF(day, cis2, cis4) > 20 and DATE\hich\af4\dbch\af31505\loch\f4 DIFF(day, cis3, cis5) > 20)  then 23009
\par 
\par \hich\af4\dbch\af31505\loch\f4           when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cis5 is null and cis4 is not null and 
\par \hich\af4\dbch\af31505\loch\f4           (DATEDIFF(day, cis1, cis3) > 20 and DATEDIFF(day, cis2, cis4) > 20)  then 23009
\par \hich\af4\dbch\af31505\loch\f4           end
\par \hich\af4\dbch\af31505\loch\f4 ) as cisreg
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_cisdays_piv)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_ocavp2_regtrts_f
\par \tab \hich\af4\dbch\af31505\loch\f4 select bene_id, trtinit_dt,
\par \tab \hich\af4\dbch\af31505\loch\f4   (case when alldrugs = 3 and Fluorouracil_fl = 1 and Hydroxyurea_fl = 1 and Radiation_fl = 1\tab \tab then 23001
\par \hich\af4\dbch\af31505\loch\f4             when alldrugs = 3 and Fluorouracil_fl = 1 and Carboplatin_fl = 1 and Radiation_fl = 1\tab \tab then 23002
\par \hich\af4\dbch\af31505\loch\f4             when alldrugs = 3 and Carboplatin_fl = 1 and Paclitaxel_fl = 1 and Radiation_fl = \hich\af4\dbch\af31505\loch\f4 1\tab \tab \tab then 23003
\par \hich\af4\dbch\af31505\loch\f4             when alldrugs = 3 and Fluorouracil_fl = 1 and Cisplatin_fl = 1 and Radiation_fl = 1\tab \tab \tab then 23007
\par \hich\af4\dbch\af31505\loch\f4             when alldrugs = 3 and Paclitaxel_fl = 1 and Cisplatin_fl = 1 and Radiation_fl = 1 \tab \tab \tab then 23008
\par \hich\af4\dbch\af31505\loch\f4             when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cisreg = 23009\tab             then 23009
\par \hich\af4\dbch\af31505\loch\f4             when alldrugs = 2 and Cisplatin_fl = 1\tab and Radiation_fl = 1 and cisreg = 23010\tab           \tab then 23010
\par \hich\af4\dbch\af31505\loch\f4      --  when alldrugs = 2 and Cisplatin_fl = 1\tab and R\hich\af4\dbch\af31505\loch\f4 adiation_fl = 1\tab                     \tab \tab     then 2300910
\par \hich\af4\dbch\af31505\loch\f4        when alldrugs = 2 and Cetuximab_fl = 1\tab and Radiation_fl = 1 and subgrp in ('Lip_oral')\tab        \tab then 23004
\par \hich\af4\dbch\af31505\loch\f4        when alldrugs = 2 and Cetuximab_fl = 1\tab and Radiation_fl = 1 and subgrp not in ('Lip_oral') \tab then 23005
\par \hich\af4\dbch\af31505\loch\f4        when alldrugs is NULL or alldrugs = 0                        then 0 --- no regimens
\par \hich\af4\dbch\af31505\loch\f4        when alldrugs = 2 and Carboplatin_fl = 1 and Radiation_fl = 1 then 888 -- non recommended
\par \hich\af4\dbch\af31505\loch\f4        else 999 --- incomp regimens
\par \tab \hich\af4\dbch\af31505\loch\f4       end\hich\af4\dbch\af31505\loch\f4 ) as trtreg
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_cisplat_f 
\par \tab 
\par \tab 
\par 
\par --\tab \hich\af4\dbch\af31505\loch\f4 select distinct trtreg, count(distinct bene_ID) as benes from IN_check group by trtreg;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- for oral cavity, we need to apply 2 more criterias using trt data 
\par 
\par -----------------------------------------------------
\par \hich\af4\dbch\af31505\loch\f4 --- clm days
\par -----------------------------------------------------
\par 
\par \hich\af4\dbch\af31505\loch\f4 Drop table IN_ocavp2_trts_f 
\par \hich\af4\dbch\af31505\loch\f4    
\par \hich\af4\dbch\af31505\loch\f4 Create table IN_ocavp2_trts_f (\tab \tab \tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,\tab 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );\tab 
\par 
\par \hich\af4\dbch\af31505\loch\f4 create clustered columnstore index ocav on IN_ocavp2_trts_f;
\par 
\par \hich\af4\dbch\af31505\loch\f4  with IN_ocavp2_Partd as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end\hich\af4\dbch\af31505\loch\f4 _fu, b.SRVC_DT as clm_dt, b.gnn as Drug_category 
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_PDE as b on a.bene_id = b.bene_id
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((SRVC_DT <= (DATEADD(DAY, 60, end_fu ))) and (SRVC_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 gnn in ('CAR\hich\af4\dbch\af31505\loch\f4 BOPLATIN', 'CETUXIMAB', 'CISPLATIN', 'DOCETAXEL', 'FLUOROURACIL', 'HYDROXYUREA', 'PACLITAXEL')),
\par \tab \tab \tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4 -------- get NCH procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_PH as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_BCARRL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                              inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_D\hich\af4\dbch\af31505\loch\f4 T >= Diag_Start_Date)) and  c.ocavp2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP hcpcs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_OP_h as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_OPR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab     inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu ))) and (REV_CNTR_DT >= Diag_Start_Date) ) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.ocavp2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par -\hich\af4\dbch\af31505\loch\f4 ------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_DME as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_DMEL as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.ocavp2 = 1            \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HHA procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_HHA as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_HHAR as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end\hich\af4\dbch\af31505\loch\f4 _fu ))) and (REV_CNTR_DT >= Diag_Start_Date)) and  
\par \tab \hich\af4\dbch\af31505\loch\f4 c.ocavp2 = 1          \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get HOSPICE procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_HOSPC as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.REV_CNTR_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_HOSPCR as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab       inner join Trt_Reg_IV as c on b.HCPCS_CD = c.HCPCS_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((REV_CNTR_DT <= (DATEADD(DAY, 60, end_fu )))\tab  and (REV_CNTR_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.ocavp2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get DME procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_DME_ndc as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.LINE_1ST_EXPNS_DT as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join FFS_DMEL as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab   inner join Trt_Reg_NDC as c on b.line_ndc_cd = c.NDC_code
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((LINE_1ST_EXPNS_DT <= (DATEADD(DAY, 60, end_fu ))) and (LINE_1ST_EXPNS_DT >= Diag_Start_Date)) and 
\par \tab \hich\af4\dbch\af31505\loch\f4  c.ocavp2 = 1         \tab 
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get IP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_IP as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, en\hich\af4\dbch\af31505\loch\f4 d_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join MC_FFS_IP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.ocavp2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- get SNF procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_SNF as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck \hich\af4\dbch\af31505\loch\f4 as a inner join MC_FFS_SNF_PROC as b on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.ocavp2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par \hich\af4\dbch\af31505\loch\f4 -------- get OP procs for benes during fu
\par \hich\af4\dbch\af31505\loch\f4     IN_ocavp2_OP_I as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select distinct a.bene_ID, Diag_Start_Date, end_fu, b.icd_proc_dt as clm_dt, c.Drug_category
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_chck as a inner join MC_FFS_OP_PROC as b\tab on a.bene_id = b.bene_id
\par \hich\af4\dbch\af31505\loch\f4                         \tab \tab        inner join Trt_Reg_IV as c on b.icd_proc = c.ICD_Proc 
\par \tab \hich\af4\dbch\af31505\loch\f4 where ((icd_proc_dt <= (DATEADD(DAY, 60, end_fu ))) and (icd_proc_dt >= Diag_Start_Date)) and c.ocavp2 = 1
\par \hich\af4\dbch\af31505\loch\f4  \tab ),
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 -------- combine claims 
\par 
\par \hich\af4\dbch\af31505\loch\f4   IN_ocavp2_4trt as (
\par \hich\af4\dbch\af31505\loch\f4          select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from\hich\af4\dbch\af31505\loch\f4  IN_ocavp2_Partd union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_PH) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_OP_h) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_DME) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_HHA) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_cate\hich\af4\dbch\af31505\loch\f4 gory from IN_ocavp2_HOSPC) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_DME_ndc) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_IP) union
\par \hich\af4\dbch\af31505\loch\f4  \tab     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_SNF) union
\par \tab \hich\af4\dbch\af31505\loch\f4     (select distinct bene_ID, Diag_Start_Date, end_fu, clm_dt, Drug_category from IN_ocavp2_OP_I)
\par 
\par \hich\af4\dbch\af31505\loch\f4   )
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 ,IN_ocavp2_chemo as  ( 
\par \hich\af4\dbch\af31505\loch\f4  \hich\af4\dbch\af31505\loch\f4    select distinct BENE_ID, Diag_Start_Date, clm_dt as chemo_clmdt,
\par \hich\af4\dbch\af31505\loch\f4                row_number() over(partition by bene_id order by clm_dt) as rownum---first_chemo
\par \hich\af4\dbch\af31505\loch\f4  from IN_ocavp2_4trt where Drug_category not in ('Radiation')
\par \hich\af4\dbch\af31505\loch\f4 ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 IN_ocavp2_rad as  ( 
\par \hich\af4\dbch\af31505\loch\f4     select distinct BENE_ID, Diag_Start_Date, clm_dt as rad_clmdt,
\par \hich\af4\dbch\af31505\loch\f4                row_number() over(partition by bene_id order by clm_dt) as rownum--- first_rad
\par \hich\af4\dbch\af31505\loch\f4  from IN_ocavp2_4trt where Drug_category in ('Radiation')
\par \hich\af4\dbch\af31505\loch\f4 ),
\par 
\par \hich\af4\dbch\af31505\loch\f4 IN_chem_1 as (select distinct BENE_ID, \hich\af4\dbch\af31505\loch\f4 Diag_Start_Date, chemo_clmdt as first_chemo from IN_ocavp2_chemo where rownum = 1),
\par \hich\af4\dbch\af31505\loch\f4 IN_rad_1 as (select distinct BENE_ID, rad_clmdt as first_rad from IN_ocavp2_rad where rownum = 1),
\par 
\par ---------------------
\par \hich\af4\dbch\af31505\loch\f4 IN_ocavp2 as (
\par \hich\af4\dbch\af31505\loch\f4 select a.*, c.Diag_Start_Date, b.first_rad, c.first_chemo
\par \hich\af4\dbch\af31505\loch\f4 from IN_ocavp2_regtrts_f a left join IN_rad_1 b on a.bene_ID = b.bene_ID
\par \hich\af4\dbch\af31505\loch\f4                          left join IN_chem_1 c on a.bene_ID = c.bene_ID )
\par \hich\af4\dbch\af31505\loch\f4  --select top 15 * from IN_ocavp2;
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_radchem as (select * from IN_ocavp2 
\par \hich\af4\dbch\af31505\loch\f4 where (f\hich\af4\dbch\af31505\loch\f4 irst_rad is not null and first_chemo is not null) and 
\par \hich\af4\dbch\af31505\loch\f4 (((DATEDIFF(Day, Diag_Start_Date, first_rad) <= 180)) or ((DATEDIFF(Day, Diag_Start_Date, first_chemo)<= 180))) and
\par \hich\af4\dbch\af31505\loch\f4 ((first_rad <= first_chemo) or (DATEDIFF(Day, first_chemo, first_rad) <=14))
\par \hich\af4\dbch\af31505\loch\f4 )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select count(distinct bene_ID) as benes from  IN_radchem;
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 --- get chemo last claim and rad 7 clms pivot
\par \hich\af4\dbch\af31505\loch\f4 , IN_chemdays_4lst as (
\par \hich\af4\dbch\af31505\loch\f4            select bene_id, chemo_clmdt,
\par \hich\af4\dbch\af31505\loch\f4            row_number() over(partition by bene_id order by chemo_clmdt desc) as RowNum from IN_ocavp2_chemo)
\par \hich\af4\dbch\af31505\loch\f4 , IN_chem_last as (select bene_ID, chemo_clmdt as lastchem from IN_chemdays_4lst where RowNum = 1)
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 , IN_raddays as (
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4    select bene_ID, rad_clmdt,
\par \tab \tab \tab \hich\af4\dbch\af31505\loch\f4    row_number() over(partition by bene_id order by rad_clmdt) as RowNum from IN_ocavp2_rad)
\par \tab ---------------------
\par \hich\af4\dbch\af31505\loch\f4 ,IN_ocavp2_lststp as (
\par \tab \hich\af4\dbch\af31505\loch\f4 select a.bene_id, trtinit_dt, trtreg , b1.first_chemo, b2.lastchem,  rad_clmdt
\par \tab \hich\af4\dbch\af31505\loch\f4 from IN_radchem a left join IN_chem_1 b1 on a.bene_ID = b1.bene_ID
\par \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4   left join IN_chem_last b2 on a.bene_ID = b2.bene_ID
\par \tab \tab \tab \tab \tab \hich\af4\dbch\af31505\loch\f4   left join IN_raddays c on a.bene_ID = c.bene_ID )
\par 
\par \hich\af4\dbch\af31505\loch\f4 --select count (distinct bene_ID) as benes from IN_ocavp2_lststp 
\par --\tab \hich\af4\dbch\af31505\loch\f4 where (rad_clmdt is not null and (rad_clmdt between first_chemo and lastchem))
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_ocavp2_trts_f
\par \hich\af4\dbch\af31505\loch\f4 select distinct bene_id, trtinit_dt, trtreg from IN_ocavp2_lststp 
\par \hich\af4\dbch\af31505\loch\f4 where (rad_clmdt is not null and (rad_clmdt between first_chemo and lastchem))
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 drop table IN_ocavp2_regtrts_f
\par 
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /***********************************************************/
\par \hich\af4\dbch\af31505\loch\f4 /****************** COMBINE ACROSS SCENARIOS **************/
\par \hich\af4\dbch\af31505\loch\f4 /*********************************************************/
\par 
\par \hich\af4\dbch\af31505\loch\f4 ---drop table IN_all_trts
\par 
\par \hich\af4\dbch\af31505\loch\f4 Create t\hich\af4\dbch\af31505\loch\f4 able IN_all_trts_f (
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 BENE_ID varchar(15) COLLATE SQL_Latin1_General_CP1_CS_AS NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtinit_dt date NULL,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 trtreg INT,
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 cancer_scen varchar(15)
\par \tab \tab \hich\af4\dbch\af31505\loch\f4 );
\par 
\par \hich\af4\dbch\af31505\loch\f4 insert into IN_all_trts_f\tab \tab \tab 
\par \hich\af4\dbch\af31505\loch\f4            select *, 'panc1' as cancer_scen from IN_Pancreas1_trts_f union -- 2523 old 2521 final
\par \hich\af4\dbch\af31505\loch\f4            select *, 'colon1' as cancer_scen from IN_Colon1_trts union -- 2506
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'rectum1' as cancer_scen from IN_Rectum1_trts union -- 1193
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'rectum2' as cancer_scen from IN_Rectum2_trts union -- 2780
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'mm1' as cancer_scen from IN_Myeloma1_trts_f union -- 4184 old. 4181 final
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'mm2' as cancer_scen from IN_Myeloma2_trts_f union -- 4768 old. 4771 final 
\par \tab \tab \hich\af4\dbch\af31505\loch\f4   \hich\af4\dbch\af31505\loch\f4  select *, 'gb' as cancer_scen from IN_Gallbladder_trts union -- 221
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'cll' as cancer_scen from IN_CLL_trts union -- 1485
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'l10' as cancer_scen from IN_Lung10_trts union -- 603
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select *, 'br6' as cancer_scen from IN_breast6_trts union -- 214
\par \hich\af4\dbch\af31505\loch\f4  \tab \tab    select *, 'ocavp2' as cancer_scen from IN_ocavp2_trts_f union -- 1884 old. 1883 final
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select bene_id COLLATE SQL_Latin1_General_CP1_CS_AS, trtinit_dt, trtreg, 'br7' as cancer_scen from IN_br7_trt union -- 2621
\par \tab \tab \hich\af4\dbch\af31505\loch\f4    select bene\hich\af4\dbch\af31505\loch\f4 _id COLLATE SQL_Latin1_General_CP1_CS_AS, trtinit_dt, trtreg, 'br8' as cancer_scen from IN_br8_trt       -- 2352
\par \tab \tab \hich\af4\dbch\af31505\loch\f4   ;
\par 
\par \hich\af4\dbch\af31505\loch\f4 --25448 final benes\tab \tab   
\par 
\par \hich\af4\dbch\af31505\loch\f4 select distinct cancer_scen, trtreg, count(bene_ID) as benes from IN_all_trts
\par \hich\af4\dbch\af31505\loch\f4 group by cancer_scen, trtreg;
\par 
\par 
\par 
\par \hich\af4\dbch\af31505\loch\f4 /************* drop individual scenario regimens - keep br7 n br8 cuz more complicated **********/
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Pancreas1_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Colon1_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Rectum1_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Rectum2_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Myeloma1_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Myeloma2_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Gallbladder_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_CLL_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_Lung10_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_breast6_trts;
\par \hich\af4\dbch\af31505\loch\f4   drop table IN_ocavp2_trts;
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par 
\par }{\*\themedata 504b030414000600080000002100e9de0fbfff0000001c020000130000005b436f6e74656e745f54797065735d2e786d6cac91cb4ec3301045f748fc83e52d4a
9cb2400825e982c78ec7a27cc0c8992416c9d8b2a755fbf74cd25442a820166c2cd933f79e3be372bd1f07b5c3989ca74aaff2422b24eb1b475da5df374fd9ad
5689811a183c61a50f98f4babebc2837878049899a52a57be670674cb23d8e90721f90a4d2fa3802cb35762680fd800ecd7551dc18eb899138e3c943d7e503b6
b01d583deee5f99824e290b4ba3f364eac4a430883b3c092d4eca8f946c916422ecab927f52ea42b89a1cd59c254f919b0e85e6535d135a8de20f20b8c12c3b0
0c895fcf6720192de6bf3b9e89ecdbd6596cbcdd8eb28e7c365ecc4ec1ff1460f53fe813d3cc7f5b7f020000ffff0300504b030414000600080000002100a5d6
a7e7c0000000360100000b0000005f72656c732f2e72656c73848fcf6ac3300c87ef85bd83d17d51d2c31825762fa590432fa37d00e1287f68221bdb1bebdb4f
c7060abb0884a4eff7a93dfeae8bf9e194e720169aaa06c3e2433fcb68e1763dbf7f82c985a4a725085b787086a37bdbb55fbc50d1a33ccd311ba548b6309512
0f88d94fbc52ae4264d1c910d24a45db3462247fa791715fd71f989e19e0364cd3f51652d73760ae8fa8c9ffb3c330cc9e4fc17faf2ce545046e37944c69e462
a1a82fe353bd90a865aad41ed0b5b8f9d6fd010000ffff0300504b0304140006000800000021006b799616830000008a0000001c0000007468656d652f746865
6d652f7468656d654d616e616765722e786d6c0ccc4d0ac3201040e17da17790d93763bb284562b2cbaebbf600439c1a41c7a0d29fdbd7e5e38337cedf14d59b
4b0d592c9c070d8a65cd2e88b7f07c2ca71ba8da481cc52c6ce1c715e6e97818c9b48d13df49c873517d23d59085adb5dd20d6b52bd521ef2cdd5eb9246a3d8b
4757e8d3f729e245eb2b260a0238fd010000ffff0300504b03041400060008000000210094a9528694070000c7200000160000007468656d652f7468656d652f
7468656d65312e786d6cec595f8b1bc9117f0fe43b0cf32e6b66248da4c5f2a1bfdeb3776d63c90ef7d82bb566dadb333d4cb7762d8e83e07bca4b207077e421
0779cb430839c8418ebce4c3186c92cb874875cf68d42db5bc7f30c184dd7dd1b47e55fd9baaeaaa52f5fdcf5e27d4b9c039272cedb9fe3dcf75703a670b9246
3df7c56c52ebb80e17285d20ca52dc73d798bb9f3df8e52feea32311e3043b209ff223d4736321b2a37a9dcf6119f17b2cc3297cb7647982043ce6517d91a34b
d09bd07ae079613d4124759d1425a0f6e97249e6d8994995ee838df23185c75470b930a7f954aac68684c22ece7d89e06b3ea4b9738168cf857d16ec72865f0b
d7a1880bf8a2e77aeacfad3fb85f4747a51015076435b989fa2be54a81c579a0f6cca3b36a536f1c749a7ea55f01a8d8c78d3bf2bfd2a700683e87372db8e83a
fd56e8758212ab818a8f16ddddb6df30f19afec61e67bf1b0e82a6a15f810afdcd3dbc37e98e472d03af4005beb587ef7bc1a0db30f00a54e0c33d7c73dc6f07
6303af403125e9f93e3a6c773a6189ae204b468fadf06e187aed5109dfa2201aaae8925b2c592a0ec55a825eb17c020009a44890d411eb0c2fd11ca2b89f09c6
9d11e119456bd7c950ca382c7b81ef43e835bda0fa571647471869d2921730e17b4b928fc3e739c944cf7d045a5d0df2eea79fdebef9f1ed9bbfbffdfaebb76f
feea9c902816852a43ee18a5912ef7f39f7ef79fef7fedfcfb6f7ffcf99b6fed78aee3dfffe537effff1cf0fa987a3b635c5bbef7e78ffe30fef7effdb7ffdf9
1b8bf67e8ece74f88c24983b4ff0a5f39c25f082ca14267f7c96df4c621623a24bf4d388a314c95d2cfac72236d04fd688220b6e804d3bbecc21d5d8800f57af
0cc2d3385f0962d1f8384e0ce0296374c072ab151ecbbd3433cf566964df3c5fe9b8e7085dd8f61ea2d4f0f27895418e253695c3181b349f51940a14e1140b47
7ec7ce31b6bcdd178418763d25f39c71b614ce17c419206235c98c9c19d1b4153a2609f8656d2308fe366c73fad219306a7beb11be3091703610b5909f616a98
f1215a0994d854ce504275839f2011db484ed7f95cc78db9004f47983267bcc09cdb649ee6f0be9ad31f23c86e56b79fd27562227341ce6d3a4f10633a72c4ce
87314a321b764ad258c77ececf214491f38c091bfc949927443e831f507ad0dd2f0936dc7d75367801594ea7b40d10f9cd2ab7f8f2216646fc4ed77489b02dd5
f4f3c448b1fd9c58a363b08a8cd03ec198a24bb4c0d879f1b985c1806586cdb7a41fc590558eb12db01e213356e5738a39f44ab2b9d9cf9327841b213bc5113b
c0e774bd9378d6284d507e48f313f0ba6ef3f1590e87d142e1299d9febc027047a408817ab519e72d0a105f741adcf62641430f9ccedf1bace0dff5de78cc1b9
7c65d0b8c6b904197c631948ecbacc076d3343d4d8601b3033449c135bba0511c3fd5b11595c95d8ca2ab7340fedd60dd01d194d4f42d22b3aa0ff5de703fdc5
bb3f7c6f09c18fd3edd8151ba9ea867dcea15472bcd3dd1cc2edf63443962fc8a7dfd28cd02a7d86a18aece7abbb8ee6aea371ffef3b9a43e7f9ae8f39d46ddc
f5312ef417777d4c395af9387dccb67581ae468e178a318f1afa2407673e4b42e954ac293ee16aecc3e1d7cc62028b524ecd3b713503cc62f828cb1c6c60e0a2
1c29192767e25744c4d31865301bf25da924e2a5ea883b19e3303252cb56dd124f57c9295b14a34e355bf28acaca91d8ae7b2d183a15eb30a612053a6c978b92
9f9aa7025fc5365263d60d01297b1312da6626898685447bb37805093935fb382cba16161da97ee3aa3d5300b5ca2bf073db811fe93db7d594846046cee7d09a
2fa49f0a576fbcab9cf9313d7dc8984604c058b1781318ca579eee4aae075f4fbe5d116ad7f0b4414239a5082b9384b28c6af0780c3f82cbe894abd7a171535f
77b72e35e84953a8fd20beb734da9d0fb1b8adaf416e3737d054cf1434752e7b6ed86841c8cc51d673973032868f4906b1c3e52f2e4423b877998bbc38f0b7c9
2c59cec508f1b830b84a3a857b122270ee5092f45cf9fa951b68aa7288e2e60790103e59725d482b9f1a3970bae964bc5ce2b9d0ddaead484b178f90e18b5c61
fd5689df1e2c25d90adc3d8d1797ce195de5cf118458abed4b032e08879b03bfb0e682c0555895c8b6f1b75398cae4afdf45a9182ad611cd625456143d991770
554f2a3aeaa9b281f654be33185433495908cf22596075a31ad5b42a5d05878355f76a2169392d696e6ba6915564d5b4673163874d19d8b1e5ed8abcc66a6362
c8697a852f52f76ecaed6e72dd4e9f505509307865bfdb957e8dda7633839a64bc9f8665ce2e57cddab179c12ba85da74868593fdca8ddb15b5523acdbc1e2ad
2a3fc8ed462d2c2d377da5b2b4ba33d7afb5d9d92b481e23e872575470e54a98ebe608bab2a9ea498ab40147e4b5288f067c725639e9b95f7aad7e7318b48635
afd31ad79a8da657ebb4fa8d5abfd56af8e396ef8d06c1575058449cf8ade2be7e02d717745ddedaabf5bd9bfb647343736fce923a5337f375455cdddcfbc1e1
9b7b8740d2f93218fbcda01f0c6bc3911fd69ac128ac75da8d7e6d1884a3a00f293d9cf4bf729d0b05f607a3d164d20a6ae110704dafdfaaf5078d612dec8c07
c1c41f37471e80cbccf91afa6fb0e9c616f051f17af05f000000ffff0300504b0304140006000800000021000dd1909fb60000001b010000270000007468656d
652f7468656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c73848f4d0ac2301484f78277086f6fd3ba109126dd88d0add40384e4350d
363f2451eced0dae2c082e8761be9969bb979dc9136332de3168aa1a083ae995719ac16db8ec8e4052164e89d93b64b060828e6f37ed1567914b284d26245228
2e3198720e274a939cd08a54f980ae38a38f56e422a3a641c8bbd048f7757da0f19b017cc524bd62107bd5001996509affb3fd381a89672f1f165dfe514173d9
850528a2c6cce0239baa4c04ca5bbabac4df000000ffff0300504b01022d0014000600080000002100e9de0fbfff0000001c0200001300000000000000000000
000000000000005b436f6e74656e745f54797065735d2e786d6c504b01022d0014000600080000002100a5d6a7e7c0000000360100000b000000000000000000
00000000300100005f72656c732f2e72656c73504b01022d00140006000800000021006b799616830000008a0000001c00000000000000000000000000190200
007468656d652f7468656d652f7468656d654d616e616765722e786d6c504b01022d001400060008000000210094a9528694070000c720000016000000000000
00000000000000d60200007468656d652f7468656d652f7468656d65312e786d6c504b01022d00140006000800000021000dd1909fb60000001b010000270000
00000000000000000000009e0a00007468656d652f7468656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c73504b050600000000050005005d010000990b00000000}
{\*\colorschememapping 3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d3822207374616e64616c6f6e653d22796573223f3e0d0a3c613a636c724d
617020786d6c6e733a613d22687474703a2f2f736368656d61732e6f70656e786d6c666f726d6174732e6f72672f64726177696e676d6c2f323030362f6d6169
6e22206267313d226c743122207478313d22646b3122206267323d226c743222207478323d22646b322220616363656e74313d22616363656e74312220616363
656e74323d22616363656e74322220616363656e74333d22616363656e74332220616363656e74343d22616363656e74342220616363656e74353d22616363656e74352220616363656e74363d22616363656e74362220686c696e6b3d22686c696e6b2220666f6c486c696e6b3d22666f6c486c696e6b222f3e}
{\*\latentstyles\lsdstimax376\lsdlockeddef0\lsdsemihiddendef0\lsdunhideuseddef0\lsdqformatdef0\lsdprioritydef99{\lsdlockedexcept \lsdqformat1 \lsdpriority0 \lsdlocked0 Normal;\lsdqformat1 \lsdpriority9 \lsdlocked0 heading 1;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 2;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 3;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 4;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 5;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 6;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 7;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 8;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 9;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 1;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 5;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 6;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 7;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 8;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 9;
\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 1;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 2;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 3;
\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 4;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 5;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 6;
\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 7;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 8;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 9;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Normal Indent;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 footnote text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 annotation text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 header;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 footer;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index heading;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority35 \lsdlocked0 caption;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 table of figures;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 envelope address;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 envelope return;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 footnote reference;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 annotation reference;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 line number;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 page number;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 endnote reference;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 endnote text;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 table of authorities;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 macro;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 toa heading;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 5;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 5;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 5;\lsdqformat1 \lsdpriority10 \lsdlocked0 Title;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Closing;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Signature;\lsdsemihidden1 \lsdunhideused1 \lsdpriority1 \lsdlocked0 Default Paragraph Font;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text Indent;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 4;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 5;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Message Header;\lsdqformat1 \lsdpriority11 \lsdlocked0 Subtitle;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Salutation;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Date;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text First Indent;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text First Indent 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Note Heading;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text Indent 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text Indent 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Block Text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Hyperlink;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 FollowedHyperlink;\lsdqformat1 \lsdpriority22 \lsdlocked0 Strong;
\lsdqformat1 \lsdpriority20 \lsdlocked0 Emphasis;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Document Map;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Plain Text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 E-mail Signature;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Top of Form;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Bottom of Form;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Normal (Web);\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Acronym;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Address;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Cite;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Code;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Definition;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Keyboard;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Preformatted;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Sample;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Typewriter;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Variable;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 annotation subject;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 No List;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Outline List 1;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Outline List 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Outline List 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Balloon Text;\lsdpriority39 \lsdlocked0 Table Grid;
\lsdsemihidden1 \lsdlocked0 Placeholder Text;\lsdqformat1 \lsdpriority1 \lsdlocked0 No Spacing;\lsdpriority60 \lsdlocked0 Light Shading;\lsdpriority61 \lsdlocked0 Light List;\lsdpriority62 \lsdlocked0 Light Grid;
\lsdpriority63 \lsdlocked0 Medium Shading 1;\lsdpriority64 \lsdlocked0 Medium Shading 2;\lsdpriority65 \lsdlocked0 Medium List 1;\lsdpriority66 \lsdlocked0 Medium List 2;\lsdpriority67 \lsdlocked0 Medium Grid 1;\lsdpriority68 \lsdlocked0 Medium Grid 2;
\lsdpriority69 \lsdlocked0 Medium Grid 3;\lsdpriority70 \lsdlocked0 Dark List;\lsdpriority71 \lsdlocked0 Colorful Shading;\lsdpriority72 \lsdlocked0 Colorful List;\lsdpriority73 \lsdlocked0 Colorful Grid;\lsdpriority60 \lsdlocked0 Light Shading Accent 1;
\lsdpriority61 \lsdlocked0 Light List Accent 1;\lsdpriority62 \lsdlocked0 Light Grid Accent 1;\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 1;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 1;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 1;
\lsdsemihidden1 \lsdlocked0 Revision;\lsdqformat1 \lsdpriority34 \lsdlocked0 List Paragraph;\lsdqformat1 \lsdpriority29 \lsdlocked0 Quote;\lsdqformat1 \lsdpriority30 \lsdlocked0 Intense Quote;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 1;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 1;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 1;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 1;\lsdpriority70 \lsdlocked0 Dark List Accent 1;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 1;
\lsdpriority72 \lsdlocked0 Colorful List Accent 1;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 1;\lsdpriority60 \lsdlocked0 Light Shading Accent 2;\lsdpriority61 \lsdlocked0 Light List Accent 2;\lsdpriority62 \lsdlocked0 Light Grid Accent 2;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 2;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 2;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 2;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 2;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 2;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 2;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 2;\lsdpriority70 \lsdlocked0 Dark List Accent 2;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 2;
\lsdpriority72 \lsdlocked0 Colorful List Accent 2;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 2;\lsdpriority60 \lsdlocked0 Light Shading Accent 3;\lsdpriority61 \lsdlocked0 Light List Accent 3;\lsdpriority62 \lsdlocked0 Light Grid Accent 3;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 3;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 3;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 3;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 3;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 3;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 3;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 3;\lsdpriority70 \lsdlocked0 Dark List Accent 3;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 3;
\lsdpriority72 \lsdlocked0 Colorful List Accent 3;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 3;\lsdpriority60 \lsdlocked0 Light Shading Accent 4;\lsdpriority61 \lsdlocked0 Light List Accent 4;\lsdpriority62 \lsdlocked0 Light Grid Accent 4;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 4;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 4;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 4;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 4;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 4;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 4;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 4;\lsdpriority70 \lsdlocked0 Dark List Accent 4;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 4;
\lsdpriority72 \lsdlocked0 Colorful List Accent 4;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 4;\lsdpriority60 \lsdlocked0 Light Shading Accent 5;\lsdpriority61 \lsdlocked0 Light List Accent 5;\lsdpriority62 \lsdlocked0 Light Grid Accent 5;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 5;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 5;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 5;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 5;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 5;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 5;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 5;\lsdpriority70 \lsdlocked0 Dark List Accent 5;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 5;
\lsdpriority72 \lsdlocked0 Colorful List Accent 5;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 5;\lsdpriority60 \lsdlocked0 Light Shading Accent 6;\lsdpriority61 \lsdlocked0 Light List Accent 6;\lsdpriority62 \lsdlocked0 Light Grid Accent 6;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 6;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 6;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 6;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 6;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 6;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 6;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 6;\lsdpriority70 \lsdlocked0 Dark List Accent 6;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 6;
\lsdpriority72 \lsdlocked0 Colorful List Accent 6;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 6;\lsdqformat1 \lsdpriority19 \lsdlocked0 Subtle Emphasis;\lsdqformat1 \lsdpriority21 \lsdlocked0 Intense Emphasis;
\lsdqformat1 \lsdpriority31 \lsdlocked0 Subtle Reference;\lsdqformat1 \lsdpriority32 \lsdlocked0 Intense Reference;\lsdqformat1 \lsdpriority33 \lsdlocked0 Book Title;\lsdsemihidden1 \lsdunhideused1 \lsdpriority37 \lsdlocked0 Bibliography;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority39 \lsdlocked0 TOC Heading;\lsdpriority41 \lsdlocked0 Plain Table 1;\lsdpriority42 \lsdlocked0 Plain Table 2;\lsdpriority43 \lsdlocked0 Plain Table 3;\lsdpriority44 \lsdlocked0 Plain Table 4;
\lsdpriority45 \lsdlocked0 Plain Table 5;\lsdpriority40 \lsdlocked0 Grid Table Light;\lsdpriority46 \lsdlocked0 Grid Table 1 Light;\lsdpriority47 \lsdlocked0 Grid Table 2;\lsdpriority48 \lsdlocked0 Grid Table 3;\lsdpriority49 \lsdlocked0 Grid Table 4;
\lsdpriority50 \lsdlocked0 Grid Table 5 Dark;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 1;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 1;
\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 1;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 1;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 1;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 1;
\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 1;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 2;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 2;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 2;
\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 2;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 2;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 2;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 2;
\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 3;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 3;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 3;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 3;
\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 3;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 3;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 3;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 4;
\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 4;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 4;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 4;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 4;
\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 4;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 4;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 5;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 5;
\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 5;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 5;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 5;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 5;
\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 5;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 6;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 6;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 6;
\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 6;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 6;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 6;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 6;
\lsdpriority46 \lsdlocked0 List Table 1 Light;\lsdpriority47 \lsdlocked0 List Table 2;\lsdpriority48 \lsdlocked0 List Table 3;\lsdpriority49 \lsdlocked0 List Table 4;\lsdpriority50 \lsdlocked0 List Table 5 Dark;
\lsdpriority51 \lsdlocked0 List Table 6 Colorful;\lsdpriority52 \lsdlocked0 List Table 7 Colorful;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 1;\lsdpriority47 \lsdlocked0 List Table 2 Accent 1;\lsdpriority48 \lsdlocked0 List Table 3 Accent 1;
\lsdpriority49 \lsdlocked0 List Table 4 Accent 1;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 1;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 1;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 1;
\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 2;\lsdpriority47 \lsdlocked0 List Table 2 Accent 2;\lsdpriority48 \lsdlocked0 List Table 3 Accent 2;\lsdpriority49 \lsdlocked0 List Table 4 Accent 2;
\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 2;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 2;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 2;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 3;
\lsdpriority47 \lsdlocked0 List Table 2 Accent 3;\lsdpriority48 \lsdlocked0 List Table 3 Accent 3;\lsdpriority49 \lsdlocked0 List Table 4 Accent 3;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 3;
\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 3;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 3;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 4;\lsdpriority47 \lsdlocked0 List Table 2 Accent 4;
\lsdpriority48 \lsdlocked0 List Table 3 Accent 4;\lsdpriority49 \lsdlocked0 List Table 4 Accent 4;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 4;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 4;
\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 4;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 5;\lsdpriority47 \lsdlocked0 List Table 2 Accent 5;\lsdpriority48 \lsdlocked0 List Table 3 Accent 5;
\lsdpriority49 \lsdlocked0 List Table 4 Accent 5;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 5;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 5;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 5;
\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 6;\lsdpriority47 \lsdlocked0 List Table 2 Accent 6;\lsdpriority48 \lsdlocked0 List Table 3 Accent 6;\lsdpriority49 \lsdlocked0 List Table 4 Accent 6;
\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 6;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 6;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 6;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Mention;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Smart Hyperlink;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Hashtag;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Unresolved Mention;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Smart Link;}}{\*\datastore 01050000
02000000180000004d73786d6c322e534158584d4c5265616465722e362e3000000000000000000000060000
d0cf11e0a1b11ae1000000000000000000000000000000003e000300feff090006000000000000000000000001000000010000000000000000100000feffffff00000000feffffff0000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffdfffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffff52006f006f007400200045006e00740072007900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000500ffffffffffffffffffffffff0c6ad98892f1d411a65f0040963251e5000000000000000000000000a081
0fc71e06dc01feffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000105000000000000}}